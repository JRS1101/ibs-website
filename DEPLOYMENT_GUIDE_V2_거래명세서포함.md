# 🚀 IBS 견적서 + 거래명세서 통합 시스템 배포 가이드 V2.0

## 📋 시스템 개요

### 🎯 **완성된 통합 시스템**
- ✅ **IBS 견적서 시스템**: 4개 항목 고정, 고급 대시보드, 차트 생성
- ✅ **IBS 거래명세서 시스템**: 견적서 연동, 회사 직인, 표준 양식
- ✅ **완벽한 연동**: 견적서 → 거래명세서 원클릭 전송
- ✅ **구글시트 통합**: 별도 시트에 각각 저장, 통합 관리

### 🔗 **시스템 연동 흐름**
```
견적서 작성 → 📋 거래명세서로 전송 → 거래명세서 자동 완성 → 구글시트 저장
     ↓                                                              ↓
구글시트 견적서 시트                                            구글시트 거래명세서 시트
     ↓                                                              ↓
고급 대시보드 & 차트                                           거래 현황 관리
```

## 📁 배포 파일 목록

### 🎯 **메인 시스템 파일**
1. **`ibs_quotation_improved.html`** (81KB)
   - 견적서 메인 시스템
   - 거래명세서 전송 버튼 포함
   - 4가지 완전 작동 기능 (메일, 엑셀, PDF, 구글시트)

2. **`ibs_transaction_statement.html`** (35KB)
   - 거래명세서 메인 시스템
   - 견적서 데이터 자동 로드
   - 회사 직인 업로드 기능
   - 4가지 완전 작동 기능

3. **`quotation_google_apps_script_4ITEMS_FIXED.js`** (43KB)
   - 구글시트 연동 스크립트
   - 견적서 + 거래명세서 처리
   - 고급 대시보드 & 차트 생성

### 📚 **가이드 문서**
4. **`거래명세서_사용법_가이드.md`**
   - 거래명세서 상세 사용법
   - 견적서 연동 방법
   - 문제 해결 가이드

5. **`DEPLOYMENT_GUIDE_V2_거래명세서포함.md`** (이 문서)
   - 통합 시스템 배포 가이드

## 🔧 배포 단계별 가이드

### 1단계: Google Apps Script 설정

#### 📝 **스크립트 배포**
1. [Google Apps Script](https://script.google.com/) 접속
2. 새 프로젝트 생성
3. `quotation_google_apps_script_4ITEMS_FIXED.js` 내용 복사 붙여넣기
4. 프로젝트명: `IBS_견적서_거래명세서_통합시스템`

#### 🔗 **웹앱 배포**
1. **배포 → 새 배포** 클릭
2. **유형**: 웹앱 선택
3. **설명**: `IBS 견적서+거래명세서 통합 시스템 V2.0`
4. **실행 계정**: 나
5. **액세스 권한**: 모든 사용자
6. **배포** 클릭
7. **웹앱 URL 복사**: `https://script.google.com/macros/s/[스크립트ID]/exec`

#### ✅ **현재 활성 URL**
```
https://script.google.com/macros/s/AKfycbxNiC6FOL20pqHFg3uQUelYgJlBk6xqArfk5k95FLhppv1m_YUuhgkM6FLs_DqyK8HIFA/exec
```
*상태: 🟢 정상 작동 중 (4개 항목 고정)*

### 2단계: 구글시트 설정

#### 📊 **자동 시트 생성**
스크립트 실행 시 자동으로 생성되는 시트들:

1. **`IBS_견적서_목록`** (39개 컬럼)
   - 견적서 데이터 저장
   - 4개 항목 고정 구조

2. **`IBS_거래명세서_목록`** (78개 컬럼)
   - 거래명세서 데이터 저장
   - 최대 10개 항목 지원

3. **`IBS_통계_대시보드`**
   - 고급 KPI 대시보드
   - 실시간 통계 및 분석

4. **`IBS_월별_요약`**
   - 월별 집계 데이터
   - 트렌드 분석

#### 🎨 **고급 차트 자동 생성**
- 📊 상태별 파이 차트
- 📈 월별 트렌드 라인 차트
- 💰 금액 분포 막대 차트

### 3단계: HTML 파일 배포

#### 🌐 **웹 호스팅 배포**

##### **GitHub Pages 배포 (권장)**
1. GitHub 저장소 생성
2. 파일 업로드:
   ```
   ├── index.html (ibs_quotation_improved.html을 복사)
   ├── transaction.html (ibs_transaction_statement.html을 복사)
   └── README.md
   ```
3. **Settings → Pages → Source: Deploy from a branch**
4. **Branch: main** 선택
5. 배포 완료 후 URL 확인

##### **로컬 파일 사용**
1. 두 HTML 파일을 같은 폴더에 저장
2. 브라우저에서 직접 열기
3. 모든 기능 정상 작동 (인터넷 연결 시)

### 4단계: URL 업데이트 (필요시)

#### 🔄 **새로운 Google Apps Script URL 적용**
새 스크립트를 배포한 경우, HTML 파일의 URL을 업데이트:

**견적서 파일 (`ibs_quotation_improved.html`)**
```javascript
// 3곳의 WEBAPP_URL 모두 업데이트
const WEBAPP_URL = 'https://script.google.com/macros/s/[새로운스크립트ID]/exec';
```

**거래명세서 파일 (`ibs_transaction_statement.html`)**
```javascript
// 1곳의 WEBAPP_URL 업데이트
const WEBAPP_URL = 'https://script.google.com/macros/s/[새로운스크립트ID]/exec';
```

## 🎯 배포 후 테스트

### ✅ **견적서 시스템 테스트**
1. **기본 기능**
   - [ ] 견적서 작성 (4개 항목)
   - [ ] 자동 계산 (천단위 콤마)
   - [ ] 데이터 보존 (로컬 스토리지)

2. **4가지 출력 기능**
   - [ ] 📧 메일 전송 (Gmail 자동 열기)
   - [ ] 📈 엑셀 다운로드 (.xlsx 파일)
   - [ ] 📄 PDF 생성 (프린트 방식)
   - [ ] 📊 구글시트 저장

3. **고급 기능**
   - [ ] 📊 고급 대시보드 생성
   - [ ] 📈 차트 생성
   - [ ] 📋 거래명세서로 전송

### ✅ **거래명세서 시스템 테스트**
1. **연동 기능**
   - [ ] 견적서에서 데이터 자동 로드
   - [ ] 고객 정보 자동 입력
   - [ ] 항목 정보 자동 변환

2. **독립 기능**
   - [ ] 직접 거래명세서 작성
   - [ ] 회사 직인 업로드
   - [ ] 거래 조건 설정

3. **4가지 출력 기능**
   - [ ] 📧 메일 전송
   - [ ] 📈 엑셀 다운로드
   - [ ] 📄 PDF 생성
   - [ ] 📊 구글시트 저장

### ✅ **구글시트 연동 테스트**
1. **데이터 저장**
   - [ ] 견적서 데이터 정상 저장
   - [ ] 거래명세서 데이터 정상 저장
   - [ ] 별도 시트에 분리 저장

2. **대시보드 기능**
   - [ ] KPI 지표 자동 계산
   - [ ] 차트 자동 생성
   - [ ] 실시간 업데이트

## 🎨 사용자 가이드

### 👥 **최종 사용자용 간단 가이드**

#### **견적서 작성 → 거래명세서 생성 워크플로우**

1. **견적서 작성**
   ```
   견적서 페이지 열기 → 고객 정보 입력 → 견적 항목 입력 → 📊 구글시트 저장
   ```

2. **거래명세서 생성**
   ```
   📋 거래명세서로 전송 클릭 → 새 창에서 자동 로드 → 거래 조건 추가 → 직인 업로드 → 📊 구글시트 저장
   ```

3. **문서 출력**
   ```
   📧 메일 전송 / 📈 엑셀 다운로드 / 📄 PDF 생성
   ```

### 📱 **접근 방법**

#### **웹 브라우저 접근**
- **견적서**: `https://[도메인]/index.html`
- **거래명세서**: `https://[도메인]/transaction.html`

#### **로컬 파일 접근**
- **견적서**: `ibs_quotation_improved.html` 더블클릭
- **거래명세서**: `ibs_transaction_statement.html` 더블클릭

## 🔒 보안 및 권한

### 🛡️ **Google Apps Script 권한**
- **스프레드시트 액세스**: 구글시트 읽기/쓰기
- **외부 서비스**: 웹앱으로 배포
- **실행 권한**: 스크립트 소유자 계정

### 🔐 **데이터 보안**
- **로컬 스토리지**: 브라우저 내 임시 저장
- **HTTPS 통신**: 구글시트 연동 시 암호화
- **권한 제어**: 구글 계정 기반 접근 제어

## 🆘 문제 해결

### ❌ **자주 발생하는 문제**

#### 1. **구글시트 저장 실패**
```
오류: "구글시트 저장에 실패했습니다"
해결: 
- 인터넷 연결 확인
- Google Apps Script URL 확인
- 구글 계정 로그인 상태 확인
```

#### 2. **거래명세서 데이터 로드 실패**
```
오류: "견적서 데이터를 찾을 수 없습니다"
해결:
- 견적서에서 "거래명세서로 전송" 버튼 먼저 클릭
- 같은 브라우저에서 작업 확인
- 로컬 스토리지 활성화 확인
```

#### 3. **PDF 생성 문제**
```
오류: PDF 생성이 안됨
해결:
- 브라우저 팝업 차단 해제
- Ctrl+P로 수동 인쇄 시도
- "PDF로 저장" 옵션 선택
```

### 🔧 **고급 문제 해결**

#### **Google Apps Script 디버깅**
1. **스크립트 편집기** 열기
2. **실행 → 함수 실행 → doPost** 테스트
3. **로그 확인**: View → Logs
4. **오류 메시지** 분석

#### **HTML 파일 디버깅**
1. **브라우저 개발자 도구** 열기 (F12)
2. **Console 탭** 확인
3. **Network 탭**에서 요청 상태 확인
4. **오류 메시지** 분석

## 📞 지원 및 업데이트

### 🛠️ **기술 지원**
- **이메일**: ibs@ibs-info.com
- **전화**: 02-1234-5678
- **운영시간**: 평일 09:00-18:00

### 🔄 **업데이트 정보**
- **현재 버전**: V2.0 (거래명세서 통합)
- **최신 기능**: 견적서 ↔ 거래명세서 완벽 연동
- **다음 업데이트**: 모바일 앱 버전 (예정)

### 📈 **성능 모니터링**
- **Google Apps Script 상태**: [현재 URL 확인](https://script.google.com/macros/s/AKfycbxNiC6FOL20pqHFg3uQUelYgJlBk6xqArfk5k95FLhppv1m_YUuhgkM6FLs_DqyK8HIFA/exec)
- **시스템 상태**: 🟢 정상 작동 중
- **마지막 업데이트**: 2024년 12월

---

## 🎉 배포 완료 체크리스트

### ✅ **배포 전 확인사항**
- [ ] Google Apps Script 배포 완료
- [ ] 웹앱 URL 정상 작동 확인
- [ ] HTML 파일 URL 업데이트 완료
- [ ] 구글시트 권한 설정 완료

### ✅ **배포 후 확인사항**
- [ ] 견적서 시스템 정상 작동
- [ ] 거래명세서 시스템 정상 작동
- [ ] 견적서 → 거래명세서 연동 확인
- [ ] 구글시트 저장 기능 확인
- [ ] 4가지 출력 기능 모두 확인

### 🚀 **배포 완료!**
```
🎯 IBS 견적서 + 거래명세서 통합 시스템 V2.0 배포 완료!

📋 견적서 시스템: ✅ 완전 작동
📋 거래명세서 시스템: ✅ 완전 작동  
🔗 시스템 연동: ✅ 완벽 연동
📊 구글시트 통합: ✅ 실시간 동기화

이제 견적서 작성부터 거래명세서 생성까지 
원클릭으로 완성되는 전문적인 문서 관리 시스템을 사용하세요!
```

---

**📋 IBS 견적서 + 거래명세서 통합 시스템 V2.0**  
*완벽한 연동, 전문적인 관리, 효율적인 업무* 