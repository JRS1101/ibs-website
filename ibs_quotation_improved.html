<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IBS ì—‘ì…€ ê²¬ì ì„œ - ìë™ê³„ì‚° ê¸°ëŠ¥ (ê°œì„ ë²„ì „)</title>


    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            scroll-behavior: auto;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #2c5aa0, #1e3f73);
            color: white;
            padding: 20px;
            border-radius: 10px;
        }
        .quote-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .form-section {
            background-color: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid #2c5aa0;
            margin-bottom: 4px;
        }
        .form-section h3 {
            font-size: 15px;
            margin: 0 0 6px 0;
            color: #2c5aa0;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 8px;
            margin-bottom: 2px;
            align-items: center;
        }
        .form-group {
            flex: 1;
        }
        label {
            font-weight: bold;
            color: #2c5aa0;
            display: block;
            margin-bottom: 2px;
            font-size: 12px;
        }
        input, select, textarea {
            width: 100%;
            padding: 5px 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            box-sizing: border-box;
            font-size: 12px;
        }
        textarea {
            resize: none;
            overflow: hidden;
        }
        /* ì…ë ¥ ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 3px rgba(44, 90, 160, 0.3);
        }
        /* ëª¨ë°”ì¼ì—ì„œ ì¤Œ ë°©ì§€ */
        input[type="text"], input[type="number"], input[type="email"], input[type="date"], select, textarea {
            font-size: 16px;
        }
        @media (max-width: 768px) {
            input[type="text"], input[type="number"], input[type="email"], input[type="date"], select, textarea {
                font-size: 16px;
            }
        }
        .quote-table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0 0 0;
            background-color: white;
            table-layout: fixed;
        }
        /* í™”ë©´ì—ì„œ ì—´ ë„ˆë¹„ ìµœì í™” */
        .quote-table th:nth-child(1) { width: 8%; }   /* NO */
        .quote-table th:nth-child(2) { width: 20%; }  /* ì„œë¹„ìŠ¤/ì œí’ˆëª… */
        .quote-table th:nth-child(3) { width: 35%; }  /* ê·œê²©/ì‚¬ì–‘ */
        .quote-table th:nth-child(4) { width: 8%; }   /* ìˆ˜ëŸ‰ */
        .quote-table th:nth-child(5) { width: 12%; }  /* ë‹¨ê°€ */
        .quote-table th:nth-child(6) { width: 12%; }  /* ê¸ˆì•¡ */
        .quote-table th:nth-child(7) { width: 5%; }   /* ì‚­ì œ */
        .quote-table th, .quote-table td {
            border: 1px solid #ddd;
            padding: 6px 4px;
            text-align: left;
            font-size: 12px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .quote-table th {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            border-bottom: 2px solid #ddd;
        }
        .quote-table input, .quote-table select {
            border: none;
            background: transparent;
            width: 100%;
            padding: 5px;
        }
        .quote-table input:focus, .quote-table select:focus, .quote-table textarea:focus {
            outline: none;
            border: 1px solid #2c5aa0;
            background-color: #f8f9fa;
        }
        .amount-input {
            text-align: right;
        }
        .total-section {
            background-color: #e3f2fd;
            padding: 10px 14px;
            border-radius: 6px;
            margin-top: 8px;
        }
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 14px;
        }
        .final-total {
            border-top: 2px solid #2c5aa0;
            padding-top: 6px;
            font-size: 16px;
            font-weight: bold;
            color: #2c5aa0;
        }
        .btn {
            background-color: #2c5aa0;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background-color: #1e3f73;
        }
        .btn-group {
            text-align: center;
            margin-top: 10px;
        }
        .editable {
            background-color: #fff;
            border: 1px solid #ddd;
        }
        .readonly {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
        }
        
        /* ì•½ì •ì‚¬í•­ ìŠ¤íƒ€ì¼ */
        .terms-section {
            margin-top: 20px;
            font-size: 11px;
            color: #666;
            background-color: #fafafa;
            padding: 15px;
            border-radius: 6px;
            border-left: 3px solid #2c5aa0;
        }
        .terms-section h4 {
            font-size: 13px;
            margin: 0 0 10px 0;
            color: #2c5aa0;
            font-weight: bold;
        }
        .terms-section ol {
            padding-left: 20px;
            line-height: 1.4;
            margin: 0;
        }
        .terms-section li {
            margin-bottom: 6px;
        }
        
        /* ë°ì´í„° ìœ ì§€ ì•Œë¦¼ */
        .data-notice {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 11px;
            color: #2e7d32;
            margin-bottom: 10px;
            text-align: center;
        }
        
        /* ë¡œê³  ëŒ€ì²´ í…ìŠ¤íŠ¸ */
        .logo-fallback {
            display: none;
            font-size: 16px;
            font-weight: bold;
            color: #2c5aa0;
            text-align: center;
            padding: 10px;
            border: 2px dashed #2c5aa0;
            border-radius: 6px;
        }
        
        /* ë°˜ì‘í˜• ì²˜ë¦¬ */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr 1fr;
                gap: 5px;
            }
            .quote-table th, .quote-table td {
                padding: 4px 2px;
                font-size: 11px;
            }
            .btn {
                padding: 8px 16px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            .container {
                margin: 10px;
                padding: 15px;
            }
        }
        
        /* ì¸ì‡„ìš© ìµœì í™” - A4 í•œ í˜ì´ì§€ ì—¬ë°± ìµœì í™” */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .btn-group {
                display: none !important;
            }
            .data-notice {
                display: none !important;
            }
            /* í¸ì§‘ ë²„íŠ¼ë“¤ ìˆ¨ê¸°ê¸° */
            .quote-table button {
                display: none !important;
            }
            .quote-table .btn {
                display: none !important;
            }
            /* ì‚­ì œ ì—´ ì „ì²´ ìˆ¨ê¸°ê¸° */
            .quote-table th:last-child,
            .quote-table td:last-child {
                display: none !important;
            }
            /* ëª¨ë“  í¸ì§‘ ê´€ë ¨ ë²„íŠ¼ ìˆ¨ê¸°ê¸° */
            button {
                display: none !important;
            }
            .btn {
                display: none !important;
            }
            @page {
                size: A4;
                margin: 0;
            }
            body {
                background-color: white;
                margin: 0;
                font-size: 11px;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 8mm 5mm;
                box-sizing: border-box;
            }
            .container {
                box-shadow: none;
                margin: 0;
                padding: 5px;
                transform: scale(1.0);
                transform-origin: center center;
                width: 100%;
                max-width: 210mm;
            }
            .header {
                margin-bottom: 8px !important;
                min-height: 50px !important;
                padding: 10px 15px !important;
                background: white !important;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                border-radius: 0 !important;
            }
            .header div {
                font-size: 20px !important;
                line-height: 1.2 !important;
            }
            .header span {
                font-size: 14px !important;
            }
            
            /* íšŒì‚¬ ì •ë³´ ì„¹ì…˜ ì¸ì‡„ ìŠ¤íƒ€ì¼ */
            .company-info-section {
                background-color: #f8f9fa !important;
                border-left: 3px solid #2c5aa0 !important;
                margin: 10px 0 !important;
                padding: 15px !important;
                border-radius: 4px !important;
                -webkit-print-color-adjust: exact !important;
            }
            .company-info-section h3 {
                color: #2c5aa0 !important;
                font-size: 14px !important;
                margin: 0 0 10px 0 !important;
                font-weight: bold !important;
            }
            .company-info-section h4 {
                color: #2c5aa0 !important;
                font-size: 16px !important;
                margin: 0 0 15px 0 !important;
                text-align: center !important;
                font-weight: bold !important;
            }
            .company-details p {
                font-size: 11px !important;
                margin: 3px 0 !important;
                line-height: 1.4 !important;
            }
            .company-seal div {
                border: 2px dashed #ccc !important;
                width: 55px !important;
                height: 55px !important;
            }
            .company-seal button {
                display: none !important;
            }
            .company-seal input[type="file"] {
                display: none !important;
            }
            /* ëª¨ë“  íŒŒì¼ ì…ë ¥ê³¼ ë²„íŠ¼ ìˆ¨ê¸°ê¸° */
            input[type="file"] {
                display: none !important;
            }
            /* íšŒì‚¬ ì •ë³´ ì„¹ì…˜ì˜ ëª¨ë“  ë²„íŠ¼ ìˆ¨ê¸°ê¸° */
            .company-info-section button {
                display: none !important;
            }
            .company-seal img {
                width: 55px !important;
                height: 55px !important;
                border-radius: 50% !important;
                object-fit: cover !important;
                display: block !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                opacity: 1 !important;
                visibility: visible !important;
            }
            .form-section {
                padding: 4px 8px !important;
                margin-bottom: 4px !important;
                background-color: transparent !important;
                border-left: none !important;
            }
            .form-section h3 {
                font-size: 12px !important;
                margin: 0 0 3px 0 !important;
                color: #2c5aa0 !important;
                font-weight: bold !important;
            }
            .form-row {
                gap: 6px !important;
                margin-bottom: 4px !important;
                grid-template-columns: 1fr 1fr 1fr 1fr !important;
                align-items: baseline !important;
            }
            .form-group {
                display: block !important;
                line-height: 1.3 !important;
                min-height: 16px !important;
                white-space: nowrap !important;
            }
            label {
                font-size: 10px !important;
                margin-bottom: 0 !important;
                color: #333 !important;
                font-weight: bold !important;
                display: inline-block !important;
                width: 55px !important;
                vertical-align: baseline !important;
                margin-right: 3px !important;
                text-align: right !important;
            }
            input, select, textarea {
                padding: 1px 2px !important;
                font-size: 10px !important;
                width: calc(100% - 62px) !important;
                border: none !important;
                background: transparent !important;
                outline: none !important;
                border-bottom: 1px dotted #666 !important;
                display: inline-block !important;
                vertical-align: baseline !important;
                line-height: 1.2 !important;
                min-height: 12px !important;
            }
            .quote-table {
                margin: 5px 0 0 0 !important;
                table-layout: fixed !important;
                width: 100% !important;
            }
            /* PDF ì¶œë ¥ ì‹œ ì—´ ë„ˆë¹„ ìµœì í™” */
            .quote-table th:nth-child(1) { width: 8% !important; }   /* NO */
            .quote-table th:nth-child(2) { width: 20% !important; }  /* ì„œë¹„ìŠ¤/ì œí’ˆëª… */
            .quote-table th:nth-child(3) { width: 42% !important; }  /* ê·œê²©/ì‚¬ì–‘ */
            .quote-table th:nth-child(4) { width: 10% !important; }  /* ìˆ˜ëŸ‰ */
            .quote-table th:nth-child(5) { width: 10% !important; }  /* ë‹¨ê°€ */
            .quote-table th:nth-child(6) { width: 10% !important; }  /* ê¸ˆì•¡ */
            .quote-table th, .quote-table td {
                padding: 6px 4px !important;
                font-size: 10px !important;
                line-height: 1.4 !important;
                vertical-align: middle !important;
                text-align: center !important;
            }
            .quote-table th {
                font-weight: bold !important;
                background-color: #f8f9fa !important;
                border-bottom: 2px solid #ddd !important;
                color: #333 !important;
            }
            .quote-table textarea {
                padding: 4px !important;
                font-size: 9px !important;
                line-height: 1.3 !important;
                height: 50px !important;
                width: 100% !important;
                border: none !important;
                background: transparent !important;
                outline: none !important;
                resize: none !important;
                text-align: left !important;
                vertical-align: top !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
            }
            .quote-table select {
                font-size: 9px !important;
                width: 100% !important;
                border: none !important;
                background: transparent !important;
                outline: none !important;
                appearance: none !important;
                -webkit-appearance: none !important;
                -moz-appearance: none !important;
            }
            .quote-table input {
                font-size: 9px !important;
                padding: 3px 4px !important;
                width: 100% !important;
                border: none !important;
                background: transparent !important;
                outline: none !important;
                text-align: center !important;
                line-height: 1.3 !important;
            }
            .quote-table input.amount-input {
                text-align: right !important;
            }
            .total-section {
                padding: 8px 12px !important;
                margin-top: 5px !important;
                background-color: transparent !important;
                border: 1px solid #ddd !important;
                border-radius: 0 !important;
            }
            .total-row {
                margin-bottom: 5px !important;
                font-size: 12px !important;
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
                padding: 2px 0 !important;
                border-bottom: 1px dotted #ddd !important;
            }
            .total-row:last-child {
                border-bottom: none !important;
            }
            .final-total {
                padding-top: 8px !important;
                font-size: 14px !important;
                border-top: 2px solid #2c5aa0 !important;
                font-weight: bold !important;
                background-color: #f8f9fa !important;
                margin-top: 5px !important;
                padding: 8px !important;
                border-bottom: none !important;
            }
            .terms-section {
                margin-top: 6px !important;
                padding: 8px !important;
                font-size: 9px !important;
                page-break-inside: avoid;
                background-color: transparent !important;
                border-left: none !important;
                border: 1px solid #ddd !important;
                border-radius: 0 !important;
            }
            .terms-section h4 {
                font-size: 11px !important;
                margin: 0 0 5px 0 !important;
            }
            .terms-section ol {
                line-height: 1.3 !important;
                padding-left: 18px !important;
                margin: 0 !important;
            }
            .terms-section li {
                margin-bottom: 3px !important;
            }
            /* ë¡œê³  ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • */
            .header img {
                height: 40px !important;
                background: transparent !important;
                border: none !important;
                box-shadow: none !important;
            }
            /* ì¶”ê°€ ì—¬ë°± ìµœì í™” */
            .quote-form {
                gap: 3px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ë°ì´í„° ìœ ì§€ ì•Œë¦¼ -->
        <div class="data-notice" id="dataNotice" style="display: none;">
            ğŸ’¾ ì…ë ¥ëœ ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ ë³´ì¡´ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨í•´ë„ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤.
        </div>
        
        <div class="header" style="display: flex; align-items: center; justify-content: space-between; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); color: #222; padding: 20px 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(44,90,160,0.12); min-height: 80px; border: 1px solid rgba(44,90,160,0.1);">
            <div style="display: flex; align-items: center; gap: 20px;">
                <img src="images/logo/íšŒì‚¬ë¡œê³ .jpg" alt="IBS Company Logo" style="height: 60px; width: auto; background: transparent; border: none; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-radius: 6px; transition: transform 0.2s ease;" onerror="this.style.display='none'; document.querySelector('.logo-fallback').style.display='flex';">
                <div class="logo-fallback" style="display: none; align-items: center; justify-content: center; width: 120px; height: 60px; background: linear-gradient(135deg, #2c5aa0, #1e3f73); color: white; border-radius: 6px; font-size: 14px; font-weight: bold; text-align: center; line-height: 1.2; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    IBS<br>SOLUTION
                </div>
                <div style="font-size: 26px; font-weight: bold; color: #1e3f73; line-height: 1.2; text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">
                    ì•„ì´ë¹„ì—ìŠ¤<br><span style="font-size:14px; font-weight:normal; color:#666; letter-spacing:2px;">INNOVATION BRIDGE SOLUTION</span>
                </div>
            </div>
            <div style="font-size: 26px; font-weight: bold; color: #222; text-align: right; line-height: 1.2;">
                <span style="color: #2c5aa0; text-shadow: 2px 2px 4px rgba(0,0,0,0.2); font-weight: 900; font-size: 32px;">I.B.S</span><br>
                <span style="font-size:18px; font-weight:normal; color:#666;">ê²¬ì ì„œ (Quotation)</span>
            </div>
        </div>

        <!-- íšŒì‚¬ ì •ë³´ -->
        <div class="company-info-section" style="margin: 20px 0; background-color: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #2c5aa0;">
            <h3 style="color: #2c5aa0; margin: 0 0 15px 0; font-size: 16px; font-weight: bold;">ğŸ“¤ ê³µê¸‰ì ì •ë³´</h3>
            
            <!-- íšŒì‚¬ëª… -->
            <div style="text-align: center; margin-bottom: 20px;">
                <h4 style="color: #2c5aa0; margin: 0; font-size: 20px; font-weight: bold;">ì•„ì´ë¹„ì—ìŠ¤ (<span style="color: #2c5aa0; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); font-weight: 900;">I.B.S</span>)</h4>
            </div>
            
            <!-- íšŒì‚¬ ì •ë³´ì™€ ëŒ€í‘œì/ì§ì¸ -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 25px; align-items: start;">
                <!-- ì™¼ìª½: íšŒì‚¬ ìƒì„¸ ì •ë³´ -->
                <div class="company-details">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 13px; line-height: 1.5;">
                        <div>
                            <p style="margin: 6px 0;"><strong>ğŸ“ ì£¼ì†Œ:</strong> ìˆ˜ì›ì‹œ ì¥ì•ˆêµ¬ ìœ¨ì „ë™ 417ë²ˆê¸¸ 52-5</p>
                            <p style="margin: 6px 0;"><strong>ğŸ“ ì „í™”:</strong> 010-3664-6268</p>
                            <p style="margin: 6px 0;"><strong>ğŸ“  íŒ©ìŠ¤:</strong> 0504-440-6268</p>
                        </div>
                        <div>
                            <p style="margin: 6px 0;"><strong>ğŸ“§ ì´ë©”ì¼:</strong> ibs@ibs-info.com</p>
                            <p style="margin: 6px 0;"><strong>ğŸŒ í™ˆí˜ì´ì§€:</strong> web.ibs-info.com</p>
                            <p style="margin: 6px 0;"><strong>ğŸ¢ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:</strong> 405-08-53668</p>
                        </div>
                    </div>
                </div>
                
                <!-- ì˜¤ë¥¸ìª½: ëŒ€í‘œìì™€ ì§ì¸ -->
                <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                    <!-- ëŒ€í‘œì ì •ë³´ -->
                    <div style="text-align: center;">
                        <p style="margin: 0 0 5px 0; font-size: 14px; font-weight: bold; color: #2c5aa0;">ğŸ‘¤ ëŒ€í‘œì</p>
                        <p style="margin: 0; font-size: 16px; font-weight: bold; color: #333;">ì´ì¤€ë¡œ</p>
                    </div>
                    
                    <!-- ì§ì¸ (ê³ ì • ì´ë¯¸ì§€) -->
                    <div class="company-seal" style="text-align: center;">
                        <img src="images/ì•„ì´ë¹„ì—ìŠ¤ì§ì¸.jpg" alt="íšŒì‚¬ ì§ì¸" style="width: 70px; height: 70px; border-radius: 50%; object-fit: cover; border: 2px solid #ddd; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div style="display: none; align-items: center; justify-content: center; width: 70px; height: 70px; border: 2px solid #ccc; border-radius: 50%; background-color: #f8f9fa; color: #666; font-size: 9px; text-align: center; line-height: 1.1;">
                            íšŒì‚¬<br>ì§ì¸
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="quote-form">
            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="form-section">
                <h3>ê¸°ë³¸ ì •ë³´</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>ê²¬ì ë²ˆí˜¸</label>
                        <input type="text" id="quoteNumber" value="IBS-2025-001">
                    </div>
                    <div class="form-group">
                        <label>ê²¬ì ì¼ì</label>
                        <input type="date" id="quoteDate">
                    </div>
                    <div class="form-group">
                        <label>ë‚©í’ˆê¸°í•œ</label>
                        <select id="deliveryDays">
                            <option value="7">7ì¼ ì´ë‚´</option>
                            <option value="10">10ì¼ ì´ë‚´</option>
                            <option value="14">14ì¼ ì´ë‚´</option>
                            <option value="21">21ì¼ ì´ë‚´</option>
                            <option value="30">30ì¼ ì´ë‚´</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>í”„ë¡œì íŠ¸ëª…</label>
                        <input type="text" id="projectName" placeholder="í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </div>

            </div>

            <!-- ê³ ê° ì •ë³´ -->
            <div class="form-section">
                <h3>ê³ ê° ì •ë³´</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>ì—…ì²´ëª…</label>
                        <input type="text" id="clientCompany" placeholder="ì—…ì²´ëª…">
                    </div>
                    <div class="form-group">
                        <label>ë‹´ë‹¹ì</label>
                        <input type="text" id="clientContact" placeholder="ë‹´ë‹¹ìëª…">
                    </div>
                    <div class="form-group">
                        <label>ì „í™”ë²ˆí˜¸</label>
                        <input type="text" id="clientPhone" placeholder="ì „í™”ë²ˆí˜¸">
                    </div>
                    <div class="form-group">
                        <label>ì´ë©”ì¼</label>
                        <input type="email" id="clientEmail" placeholder="ì´ë©”ì¼">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ì£¼ì†Œ</label>
                        <input type="text" id="clientAddress" placeholder="ì£¼ì†Œ">
                    </div>
                    <div class="form-group">
                        <label>ìƒíƒœ</label>
                        <select id="quoteStatus" onchange="autoSaveData()">
                            <option value="ê²¬ì  ë°œí–‰">ê²¬ì  ë°œí–‰</option>
                            <option value="ê²¬ì  ì§„í–‰ì¤‘">ê²¬ì  ì§„í–‰ì¤‘</option>
                            <option value="ê³„ì•½ ì„±ì‚¬">ê³„ì•½ ì„±ì‚¬</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ê²°ì œì¡°ê±´</label>
                        <select id="paymentTerms">
                            <option value="ì„ ì…ê¸ˆ">ì„ ì…ê¸ˆ</option>
                            <option value="ì°©ìˆ˜ê¸ˆ 50% + ì™„ë£Œ í›„ 50%">ì°©ìˆ˜ê¸ˆ 50% + ì™„ë£Œ í›„ 50%</option>
                            <option value="ì™„ë£Œ í›„ ì§€ê¸‰">ì™„ë£Œ í›„ ì§€ê¸‰</option>
                            <option value="í˜‘ì˜">í˜‘ì˜</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²¬ì  í•­ëª© í…Œì´ë¸” -->
        <table class="quote-table" id="quoteTable">
            <thead>
                <tr>
                    <th style="width: 50px;">NO</th>
                    <th style="width: 140px;">ì„œë¹„ìŠ¤/ì œí’ˆëª…</th>
                    <th style="width: 300px;">ê·œê²©/ì‚¬ì–‘</th>
                    <th style="width: 60px;">ìˆ˜ëŸ‰</th>
                    <th style="width: 100px;">ë‹¨ê°€</th>
                    <th style="width: 100px;">ê¸ˆì•¡</th>
                    <th style="width: 50px;">ì‚­ì œ</th>
                </tr>
            </thead>
            <tbody id="quoteItems">
                <tr>
                    <td>1</td>
                    <td>
                        <select onchange="updateSpecs(this)" class="editable">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                            <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                            <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                            <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                            <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                            <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                            <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                            <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                            <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                        </select>
                    </td>
                    <td><textarea rows="3" class="editable"></textarea></td>
                    <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" onchange="formatPriceInput(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" readonly class="readonly amount-input"></td>
                    <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>
                        <select onchange="updateSpecs(this)" class="editable">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                            <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                            <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                            <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                            <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                            <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                            <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                            <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                            <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                        </select>
                    </td>
                    <td><textarea rows="3" class="editable"></textarea></td>
                    <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" onchange="formatPriceInput(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" readonly class="readonly amount-input"></td>
                    <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>
                        <select onchange="updateSpecs(this)" class="editable">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                            <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                            <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                            <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                            <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                            <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                            <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                            <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                            <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                        </select>
                    </td>
                    <td><textarea rows="3" class="editable"></textarea></td>
                    <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" onchange="formatPriceInput(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" readonly class="readonly amount-input"></td>
                    <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>
                        <select onchange="updateSpecs(this)" class="editable">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                            <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                            <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                            <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                            <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                            <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                            <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                            <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                            <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                        </select>
                    </td>
                    <td><textarea rows="3" class="editable"></textarea></td>
                    <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" onchange="formatPriceInput(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" readonly class="readonly amount-input"></td>
                    <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
                </tr>
            </tbody>
        </table>

        <div class="btn-group">
            <button onclick="addRow()" class="btn">í•­ëª© ì¶”ê°€</button>
            <button onclick="clearAll()" class="btn" style="background-color: #6c757d;">ì „ì²´ ì´ˆê¸°í™”</button>
        </div>

        <!-- í• ì¸/ì¶”ê°€ ì„œë¹„ìŠ¤ -->
        <div class="form-section">
            <h3>í• ì¸ ë° ì¶”ê°€ ì„œë¹„ìŠ¤</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>í• ì¸ ê¸ˆì•¡</label>
                    <input type="text" id="discountAmount" value="0" onchange="formatDiscountInput(this)" placeholder="í• ì¸ ê¸ˆì•¡">
                </div>
                <div class="form-group">
                                            <label>ì¶”ê°€ ì„œë¹„ìŠ¤</label>
                        <input type="text" id="additionalAmount" value="0" onchange="formatAdditionalInput(this)" placeholder="ì¶”ê°€ ì„œë¹„ìŠ¤">
                </div>
            </div>
        </div>

        <!-- í•©ê³„ -->
        <div class="total-section">
            <div class="total-row">
                <span>ì†Œê³„:</span>
                <span id="subtotal">0ì›</span>
            </div>
            <div class="total-row">
                <span>í• ì¸:</span>
                <span id="discount">0ì›</span>
            </div>
            <div class="total-row">
                <span>ì¶”ê°€ ì„œë¹„ìŠ¤:</span>
                <span id="additional">0ì›</span>
            </div>
            <div class="total-row">
                <span>ê²¬ì ê¸ˆì•¡:</span>
                <span id="totalBeforeVat">0ì›</span>
            </div>
            <div class="total-row">
                <span>ë¶€ê°€ì„¸(10%):</span>
                <span id="vat">0ì›</span>
            </div>
            <div class="total-row final-total">
                <span>ì´ ê³„ì•½ê¸ˆì•¡:</span>
                <span id="finalTotal">0ì›</span>
            </div>
        </div>

        <!-- ì•½ì •ì‚¬í•­ ì¶”ê°€ -->
        <div class="terms-section">
            <h4>â€» ì•½ì •ì‚¬í•­</h4>
            <ol>
                <li>ê³µê¸‰ìê°€ ë‹¹ì‚¬ì˜ ì‚¬ì „ìŠ¹ì¸ì—†ì´ ë³¸ ê²¬ì ì„œì— ëª…ê¸°ëœ ì¸ë„ì¥ì†Œê°€ ì•„ë‹Œ ì œ3ì˜ ì¥ì†Œë¡œ ë‚©í’ˆí•˜ëŠ” ê²½ìš° ë‹¹ì‚¬ëŠ” ê³µê¸‰ìì— ëŒ€í•œ ëŒ€ê¸ˆì§€ê¸‰ì˜ë¬´ë¥¼ ë©´í•œë‹¤.</li>
                <li>ê³µê¸‰ìê°€ ì •ìƒì ì¸ ì˜ì—… ë˜ëŠ” ë‚©í’ˆì´ ë¶ˆê°€í•¨ì´ ëª…ë°±í•œ ê²½ìš° ë‹¹ì‚¬ëŠ” ë³¸ ê²¬ì ì„œë¥¼ í•´ì§€í•  ìˆ˜ ìˆë‹¤.</li>
                <li>ê³µê¸‰ìëŠ” ë³¸ ê²¬ì ìƒì˜ ì±„ê¶Œì„ ë‹¹ì‚¬ì˜ ì‚¬ì „ìŠ¹ì¸ì—†ì´ ì œ3ìì—ê²Œ ì–‘ë„í•  ìˆ˜ ì—†ë‹¤.</li>
                <li>ë‚©í’ˆí•œ ë¬¼í’ˆì— ëŒ€í•œ ë‹¹ì‚¬ ë˜ëŠ” ë‹¹ì‚¬ê³ ê°ì˜ ê²€ìˆ˜ìš”êµ¬ ì‹œ ê³µê¸‰ìëŠ” ì´ì— í˜‘ì¡°í•˜ì—¬ì•¼ í•œë‹¤.</li>
                <li>ê¸°íƒ€ ëª…ì‹œë˜ì§€ ì•Šì€ ì¼ë°˜ì ì¸ ì‚¬í•­ì€ ë³„ë„ ê³„ì•½ì„œë‚˜ ì¼ë°˜ì ì¸ ìƒê´€ë¡€ì— ë”°ë¥¸ë‹¤.</li>
            </ol>
        </div>

        <div class="btn-group">
                          <button onclick="sendEmail()" class="btn" style="background-color: #ea4335;">ğŸ“§ ë©”ì¼ ì „ì†¡</button>
              <button onclick="downloadExcel()" class="btn">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
              <button onclick="downloadPDF()" class="btn">ğŸ“„ PDF ìƒì„±</button>
              <button onclick="downloadEnglishPDF()" class="btn" style="background-color: #17a2b8;">ğŸŒ ì˜ë¬¸ PDF</button>
              <button onclick="saveToGoogleSheets()" class="btn" style="background-color: #0f9d58;">ğŸ“Š êµ¬ê¸€ì‹œíŠ¸ ì €ì¥</button>
              <button onclick="sendToTransaction()" class="btn" style="background-color: #ff6b35;">ğŸ“‹ ê±°ë˜ëª…ì„¸ì„œë¡œ ì „ì†¡</button>
              <button onclick="sendToInvoice()" class="btn" style="background-color: #6f42c1;">ğŸ’° ì¸ë³´ì´ìŠ¤ ìƒì„±</button>
            <button onclick="openGoogleSheets()" class="btn" style="background-color: #4285f4;">ğŸ“‹ ì‹œíŠ¸ ì—´ê¸°</button>
            <button onclick="setupDropdowns()" class="btn" style="background-color: #28a745;">ğŸ›ï¸ ë“œë¡­ë‹¤ìš´ ì„¤ì •</button>
            <button onclick="fixDashboard()" class="btn" style="background-color: #ff6b35;">ğŸ“Š ê³ ê¸‰ ëŒ€ì‹œë³´ë“œ</button>
            <button onclick="createCharts()" class="btn" style="background-color: #9c27b0;">ğŸ“ˆ ì°¨íŠ¸ ìƒì„±</button>
                          <button onclick="autoSaveData()" class="btn" style="background-color: #28a745;">ë°ì´í„° ë³´ì¡´</button>
              <button onclick="saveQuotationForDelivery()" class="btn" style="background-color: #17a2b8;">ğŸ’¾ ê²¬ì ì„œ ì €ì¥</button>
        </div>
    </div>

    <script>
        // ìŠ¤í¬ë¡¤ ë°©ì§€ í•¨ìˆ˜
        function preventScroll() {
            // ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€
            document.addEventListener('focusin', function(e) {
                if (e.target.matches('input, select, textarea')) {
                    // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                    
                    // í¬ì»¤ìŠ¤ í›„ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë³µì›
                    setTimeout(() => {
                        window.scrollTo(scrollLeft, scrollTop);
                    }, 0);
                }
            });
            
            // ì…ë ¥ ì¤‘ ìŠ¤í¬ë¡¤ ë°©ì§€
            document.addEventListener('input', function(e) {
                if (e.target.matches('input, select, textarea')) {
                    e.target.scrollIntoView = function() {}; // scrollIntoView ë¹„í™œì„±í™”
                }
            });
        }
        
        // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì • ë° ë°ì´í„° ë³µì›
        document.addEventListener('DOMContentLoaded', function() {
            // ìŠ¤í¬ë¡¤ ë°©ì§€ ê¸°ëŠ¥ í™œì„±í™”
            preventScroll();
            
            document.getElementById('quoteDate').value = new Date().toISOString().split('T')[0];
            ensureFourRows(); // í•­ìƒ 4ê°œ í•­ëª© ë³´ì¥
            
            // ì´ˆê¸° í• ì¸/ì¶”ê°€ ê¸ˆì•¡ í¬ë§·íŒ… ì ìš©
            const discountInput = document.getElementById('discountAmount');
            const additionalInput = document.getElementById('additionalAmount');
            discountInput.value = formatNumber(parseNumber(discountInput.value));
            additionalInput.value = formatNumber(parseNumber(additionalInput.value));
            
            updateTotals();
            loadSavedData();
            
            // ê²¬ì ì„œ ì§ì¸ ì—…ë¡œë“œ ê¸°ëŠ¥ ì„¤ì •
    
            

        });
        

        

        
        // ì„œë¹„ìŠ¤ë³„ ê¸°ë³¸ ì‚¬ì–‘ ë°ì´í„° (ê¸°ì¡´ + ì¶”ê°€ 3ê°œ)
        const serviceSpecs = {
            'Wire Probe JIG ì„¤ê³„': {
                spec: 'â–¶ ê±°ë²„íŒŒì¼ ë¶„ì„ ë° ìµœì í™” ì„¤ê³„\nâ–¶ 20ë…„ ê²½ë ¥ ì „ë¬¸ê°€ ì§ì ‘ ì„¤ê³„\nâ–¶ 3D ëª¨ë¸ë§ ë° ë„ë©´ ì œê³µ\nâ–¶ ì„¤ê³„ ê²€ì¦ ë° ì‹œë®¬ë ˆì´ì…˜',
                price: 2000000
            },
            'JIG ì œì‘ ì„œë¹„ìŠ¤': {
                spec: 'â–¶ ì„¤ê³„ ì™„ë£Œ í›„ ì™„ì œí’ˆ ì œì‘\nâ–¶ í’ˆì§ˆ ê²€ì¦ ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ\nâ–¶ 1ë…„ ë¬´ìƒ A/S í¬í•¨\nâ–¶ í˜„ì¥ ì„¤ì¹˜ ë° êµìœ¡',
                price: 3000000
            },
            'MEMS JIG ê°œë°œ': {
                spec: 'â–¶ ì„¸ê³„ ìµœì´ˆ ì „ê¸°ê²€ì‚¬ MEMS JIG\nâ–¶ 20~30ã› í†µí•© Structure ì„¤ê³„\nâ–¶ ê³ ì •ë°€ ì¸¡ì • ì†”ë£¨ì…˜\nâ–¶ ì™„ì œí’ˆ ì œì‘ í¬í•¨',
                price: 5000000
            },
            'ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡': {
                                        spec: 'â–¶ IA-Station, EZ-Cat êµìœ¡\nâ–¶ Cam350, AutoCAD í™œìš©ë²•\nâ–¶ 1:1 ë§ì¶¤ êµìœ¡ (8ì‹œê°„)\nâ–¶ ì‹¤ìŠµ ìë£Œ ë° ë§¤ë‰´ì–¼ ì œê³µ',
                price: 500000
            },
            'ê¸°ìˆ  ì»¨ì„¤íŒ…': {
                spec: 'â–¶ 20ë…„ ë…¸í•˜ìš° ê¸°ë°˜ ê¸°ìˆ  ì»¨ì„¤íŒ…\nâ–¶ ì„¤ê³„ í”„ë¡œì„¸ìŠ¤ ìµœì í™”\nâ–¶ ë¹„ìš© ì ˆê° ë°©ì•ˆ ì œì‹œ\nâ–¶ ì •ê¸° ê¸°ìˆ  ì§€ì›',
                price: 1000000
            },
            'PCB ì„¤ê³„ ì„œë¹„ìŠ¤': {
                spec: 'â–¶ ë‹¤ì¸µ PCB ì„¤ê³„ ë° ìµœì í™”\nâ–¶ EMI/EMC ê³ ë ¤ ì„¤ê³„\nâ–¶ ë¶€í’ˆ ë°°ì¹˜ ìµœì í™”\nâ–¶ ì œì¡°ì„± ê²€í†  í¬í•¨',
                price: 1500000
            },
            'í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘': {
                spec: 'â–¶ ICT/FCT í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜\nâ–¶ ì •ë°€ ê°€ê³µ ë° ì¡°ë¦½\nâ–¶ ì„±ëŠ¥ ê²€ì¦ ì™„ë£Œ\nâ–¶ ìœ ì§€ë³´ìˆ˜ ë§¤ë‰´ì–¼ ì œê³µ',
                price: 2500000
            },
            'í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤': {
                spec: 'â–¶ í…ŒìŠ¤íŠ¸ í”„ë¡œê·¸ë¨ ê°œë°œ\nâ–¶ ìë™í™” ì‹œìŠ¤í…œ êµ¬ì¶•\nâ–¶ ë””ë²„ê¹… ë° ìµœì í™”\nâ–¶ ê¸°ìˆ  ë¬¸ì„œ ì‘ì„±',
                price: 800000
            }
        };

        function updateSpecs(selectElement) {
            // ê·œê²©/ì‚¬ì–‘ì€ ì§ì ‘ ì…ë ¥í•˜ë„ë¡ ë³€ê²½ - ìë™ ìƒì„± ì œê±°
            autoSaveData();
        }

        // ì²œë‹¨ìœ„ ì½¤ë§ˆ í¬ë§·íŒ… í•¨ìˆ˜
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        // ì½¤ë§ˆ ì œê±°í•˜ì—¬ ìˆ«ìë¡œ ë³€í™˜
        function parseNumber(str) {
            return parseFloat(str.toString().replace(/,/g, '')) || 0;
        }
        
        function calculateAmount(input) {
            const row = input.closest('tr');
            const quantity = parseNumber(row.cells[3].querySelector('input').value);
            const price = parseNumber(row.cells[4].querySelector('input').value);
            const amount = quantity * price;
            
            // ê¸ˆì•¡ í•„ë“œì— ì²œë‹¨ìœ„ ì½¤ë§ˆ ì ìš©
            row.cells[5].querySelector('input').value = formatNumber(amount);
            updateTotals();
            autoSaveData();
        }

        // ë‹¨ê°€ ì…ë ¥ ì‹œ ì²œë‹¨ìœ„ ì½¤ë§ˆ ì ìš©
        function formatPriceInput(input) {
            const value = parseNumber(input.value);
            input.value = formatNumber(value);
            calculateAmount(input);
        }
        
        // í• ì¸ ê¸ˆì•¡ ì…ë ¥ ì‹œ ì²œë‹¨ìœ„ ì½¤ë§ˆ ì ìš©
        function formatDiscountInput(input) {
            const value = parseNumber(input.value);
            input.value = formatNumber(value);
            updateTotals();
        }
        
        // ì¶”ê°€ ì„œë¹„ìŠ¤ ì…ë ¥ ì‹œ ì²œë‹¨ìœ„ ì½¤ë§ˆ ì ìš©
        function formatAdditionalInput(input) {
            const value = parseNumber(input.value);
            input.value = formatNumber(value);
            updateTotals();
        }
        
        function updateTotals() {
            const rows = document.querySelectorAll('#quoteItems tr');
            let subtotal = 0;
            
            rows.forEach(row => {
                const amount = parseNumber(row.cells[5].querySelector('input').value);
                subtotal += amount;
            });
            
            const discount = parseNumber(document.getElementById('discountAmount').value);
            const additional = parseNumber(document.getElementById('additionalAmount').value);
            const totalBeforeVat = subtotal - discount + additional;
            const vat = Math.round(totalBeforeVat * 0.1);
            const finalTotal = totalBeforeVat + vat;
            
            document.getElementById('subtotal').textContent = formatNumber(subtotal) + 'ì›';
            document.getElementById('discount').textContent = formatNumber(discount) + 'ì›';
            document.getElementById('additional').textContent = formatNumber(additional) + 'ì›';
            document.getElementById('totalBeforeVat').textContent = formatNumber(totalBeforeVat) + 'ì›';
            document.getElementById('vat').textContent = formatNumber(vat) + 'ì›';
            document.getElementById('finalTotal').textContent = formatNumber(finalTotal) + 'ì›';
        }

        function addRow() {
            const tbody = document.getElementById('quoteItems');
            const currentRows = tbody.children.length;
            
            // ìµœëŒ€ 4ê°œ í•­ëª©ê¹Œì§€ë§Œ í—ˆìš©
            if (currentRows >= 4) {
                alert('ìµœëŒ€ 4ê°œ í•­ëª©ê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            const newRowNum = currentRows + 1;
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td>${newRowNum}</td>
                <td>
                    <select onchange="updateSpecs(this)" class="editable">
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                        <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                        <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                        <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                        <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                        <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                        <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                        <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                        <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                    </select>
                </td>
                                    <td><textarea rows="3" class="editable" onchange="autoSaveData()"></textarea></td>
                <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                <td><input type="number" value="0" onchange="calculateAmount(this)" class="editable amount-input"></td>
                <td><input type="number" value="0" readonly class="readonly amount-input"></td>
                <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
            `;
            
            tbody.appendChild(newRow);
            autoSaveData();
        }

        function clearRow(button) {
            const row = button.closest('tr');
            
            // í–‰ì˜ ë‚´ìš©ì„ ì´ˆê¸°í™” (ì‚­ì œí•˜ì§€ ì•ŠìŒ)
            row.cells[1].querySelector('select').value = '';
            row.cells[2].querySelector('textarea').value = '';
            row.cells[3].querySelector('input').value = 1;
            row.cells[4].querySelector('input').value = 0;
            row.cells[5].querySelector('input').value = 0;
            
            updateTotals();
            autoSaveData();
        }

        function removeRow(button) {
            // ê¸°ì¡´ í•¨ìˆ˜ í˜¸í™˜ì„±ì„ ìœ„í•´ clearRowë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
            clearRow(button);
        }

        function updateRowNumbers() {
            const rows = document.querySelectorAll('#quoteItems tr');
            rows.forEach((row, index) => {
                row.cells[0].textContent = index + 1;
            });
        }

        function clearAll() {
            if (confirm('ëª¨ë“  ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.querySelectorAll('input, select, textarea').forEach(element => {
                    if (element.type === 'date') {
                        element.value = new Date().toISOString().split('T')[0];
                    } else if (element.type === 'number') {
                        element.value = 0;
                    } else {
                        element.value = '';
                    }
                });
                
                // í•­ìƒ 4ê°œ í•­ëª© ìœ ì§€
                ensureFourRows();
                
                // í• ì¸/ì¶”ê°€ ê¸ˆì•¡ í•„ë“œì— ì²œë‹¨ìœ„ ì½¤ë§ˆ ì ìš©
                document.getElementById('discountAmount').value = formatNumber(0);
                document.getElementById('additionalAmount').value = formatNumber(0);
                
                updateTotals();
                localStorage.removeItem('ibsQuoteData');
                document.getElementById('dataNotice').style.display = 'none';
            }
        }

        // í•­ìƒ 4ê°œ í•­ëª©ì„ ìœ ì§€í•˜ëŠ” í•¨ìˆ˜
        function ensureFourRows() {
            const tbody = document.getElementById('quoteItems');
            const currentRows = tbody.children.length;
            
            // 4ê°œë³´ë‹¤ ë§ìœ¼ë©´ ì œê±°
            while (tbody.children.length > 4) {
                tbody.removeChild(tbody.lastChild);
            }
            
            // 4ê°œë³´ë‹¤ ì ìœ¼ë©´ ì¶”ê°€
            while (tbody.children.length < 4) {
                const newRowNum = tbody.children.length + 1;
                const newRow = document.createElement('tr');
                
                newRow.innerHTML = `
                    <td>${newRowNum}</td>
                    <td>
                        <select onchange="updateSpecs(this)" class="editable">
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="Wire Probe JIG ì„¤ê³„">Wire Probe JIG ì„¤ê³„</option>
                            <option value="JIG ì œì‘ ì„œë¹„ìŠ¤">JIG ì œì‘ ì„œë¹„ìŠ¤</option>
                            <option value="MEMS JIG ê°œë°œ">MEMS JIG ê°œë°œ</option>
                            <option value="ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡">ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡</option>
                            <option value="ê¸°ìˆ  ì»¨ì„¤íŒ…">ê¸°ìˆ  ì»¨ì„¤íŒ…</option>
                            <option value="PCB ì„¤ê³„ ì„œë¹„ìŠ¤">PCB ì„¤ê³„ ì„œë¹„ìŠ¤</option>
                            <option value="í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘">í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘</option>
                            <option value="í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤">í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤</option>
                            <option value="ì§ì ‘ì…ë ¥">ì§ì ‘ì…ë ¥</option>
                        </select>
                    </td>
                    <td><textarea rows="3" class="editable" onchange="autoSaveData()"></textarea></td>
                    <td><input type="number" value="1" onchange="calculateAmount(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" onchange="formatPriceInput(this)" class="editable amount-input"></td>
                    <td><input type="text" value="0" readonly class="readonly amount-input"></td>
                    <td><button onclick="clearRow(this)" class="btn" style="background-color: #6c757d; font-size: 12px; padding: 5px 10px;">ì´ˆê¸°í™”</button></td>
                `;
                
                tbody.appendChild(newRow);
            }
        }

        function autoSaveData() {
            const formData = {
                quoteNumber: document.getElementById('quoteNumber').value,
                quoteDate: document.getElementById('quoteDate').value,
                deliveryDays: document.getElementById('deliveryDays').value,
                projectName: document.getElementById('projectName').value,
                paymentTerms: document.getElementById('paymentTerms').value,
                clientCompany: document.getElementById('clientCompany').value,
                clientContact: document.getElementById('clientContact').value,
                clientPhone: document.getElementById('clientPhone').value,
                clientEmail: document.getElementById('clientEmail').value,
                clientAddress: document.getElementById('clientAddress').value,
                quoteStatus: document.getElementById('quoteStatus').value,
                discountAmount: document.getElementById('discountAmount').value,
                additionalAmount: document.getElementById('additionalAmount').value,
                items: [],
                timestamp: new Date().getTime()
            };
            
            const rows = document.querySelectorAll('#quoteItems tr');
            rows.forEach(row => {
                const service = row.cells[1].querySelector('select').value;
                const spec = row.cells[2].querySelector('textarea').value;
                const quantity = row.cells[3].querySelector('input').value;
                const price = row.cells[4].querySelector('input').value;
                const amount = row.cells[5].querySelector('input').value;
                
                formData.items.push({
                    service, spec, quantity, price, amount
                });
            });
            
            localStorage.setItem('ibsQuoteData', JSON.stringify(formData));
            
            const notice = document.getElementById('dataNotice');
            notice.style.display = 'block';
            setTimeout(() => {
                notice.style.display = 'none';
            }, 3000);
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('ibsQuoteData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                const oneHour = 60 * 60 * 1000;
                if (new Date().getTime() - data.timestamp < oneHour) {
                    document.getElementById('quoteNumber').value = data.quoteNumber || '';
                    document.getElementById('quoteDate').value = data.quoteDate || new Date().toISOString().split('T')[0];
                    document.getElementById('deliveryDays').value = data.deliveryDays || '7';
                    document.getElementById('projectName').value = data.projectName || '';
                    document.getElementById('paymentTerms').value = data.paymentTerms || 'ì„ ì…ê¸ˆ';
                    document.getElementById('clientCompany').value = data.clientCompany || '';
                    document.getElementById('clientContact').value = data.clientContact || '';
                    document.getElementById('clientPhone').value = data.clientPhone || '';
                    document.getElementById('clientEmail').value = data.clientEmail || '';
                    document.getElementById('clientAddress').value = data.clientAddress || '';
                    document.getElementById('quoteStatus').value = data.quoteStatus || 'ê²¬ì  ë°œí–‰';
                    document.getElementById('discountAmount').value = formatNumber(parseNumber(data.discountAmount) || 0);
                    document.getElementById('additionalAmount').value = formatNumber(parseNumber(data.additionalAmount) || 0);
                    
                    // í•­ìƒ 4ê°œ í•­ëª© ìœ ì§€í•˜ë©´ì„œ ë°ì´í„° ë³µì›
                    ensureFourRows();
                    
                    if (data.items && data.items.length > 0) {
                        const tbody = document.getElementById('quoteItems');
                        const rows = tbody.querySelectorAll('tr');
                        
                        // ìµœëŒ€ 4ê°œ í•­ëª©ê¹Œì§€ë§Œ ë³µì›
                        data.items.slice(0, 4).forEach((item, index) => {
                            if (rows[index]) {
                                rows[index].cells[1].querySelector('select').value = item.service || '';
                                rows[index].cells[2].querySelector('textarea').value = item.spec || '';
                                rows[index].cells[3].querySelector('input').value = item.quantity || 1;
                                rows[index].cells[4].querySelector('input').value = item.price || 0;
                                rows[index].cells[5].querySelector('input').value = item.amount || 0;
                            }
                        });
                        
                        updateTotals();
                        document.getElementById('dataNotice').style.display = 'block';
                        document.getElementById('dataNotice').innerHTML = 'ğŸ’¾ ì´ì „ì— ì…ë ¥ëœ ë°ì´í„°ê°€ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤.';
                    }
                }
            }
        }



        // ì‹¤ì œ Excel íŒŒì¼(.xlsx) ìë™ ìƒì„± í•¨ìˆ˜
        async function downloadExcel() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'ì—‘ì…€ ìƒì„± ì¤‘...';
            btn.disabled = true;
            
            try {
                // SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ ë™ì  ë¡œë“œ
                if (typeof XLSX === 'undefined') {
                    await loadScript('https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js');
                }
                
                // ì›Œí¬ë¶ ìƒì„±
                const wb = XLSX.utils.book_new();
                
                // ê²¬ì ì„œ ë°ì´í„° ì¤€ë¹„
                const data = [];
                
                // ì œëª©
                data.push(['IBS ê²¬ì ì„œ (ê°œì„ ë²„ì „)', '', '', '', '', '']);
                data.push(['ì•„ì´ë¹„ì—ìŠ¤(I.B.S) - InnoBridge SOLUTION', '', '', '', '', '']);
                data.push(['', '', '', '', '', '']);
                
                // ê¸°ë³¸ ì •ë³´
                data.push(['ê²¬ì ë²ˆí˜¸:', document.getElementById('quoteNumber').value, '', 'ê²¬ì ì¼ì:', document.getElementById('quoteDate').value, '']);
                data.push(['í”„ë¡œì íŠ¸ëª…:', document.getElementById('projectName').value, '', 'ë‚©í’ˆê¸°í•œ:', document.getElementById('deliveryDays').selectedOptions[0].text, '']);
                data.push(['ê²°ì œì¡°ê±´:', document.getElementById('paymentTerms').value, '', 'ìƒíƒœ:', document.getElementById('quoteStatus').value, '']);
                data.push(['', '', '', '', '', '']);
                
                // ê³ ê°/ê³µê¸‰ì ì •ë³´
                data.push(['ê³ ê°ì •ë³´', '', '', 'ê³µê¸‰ìì •ë³´', '', '']);
                data.push(['ì—…ì²´ëª…:', document.getElementById('clientCompany').value, '', 'ìƒí˜¸:', 'ì•„ì´ë¹„ì—ìŠ¤(I.B.S)', '']);
                data.push(['ë‹´ë‹¹ì:', document.getElementById('clientContact').value, '', 'ë‹´ë‹¹ì:', 'ì´ì¤€ë¡œ ëŒ€í‘œ', '']);
                data.push(['ì „í™”ë²ˆí˜¸:', document.getElementById('clientPhone').value, '', 'ì „í™”ë²ˆí˜¸:', '010-3664-6268', '']);
                data.push(['ì´ë©”ì¼:', document.getElementById('clientEmail').value, '', 'ì´ë©”ì¼:', 'jr.lee@ibs-info.com', '']);
                data.push(['ì£¼ì†Œ:', document.getElementById('clientAddress').value, '', 'ì£¼ì†Œ:', 'ê²½ê¸°ë„ ìˆ˜ì›ì‹œ ì¥ì•ˆêµ¬ ë•ì˜ëŒ€ë¡œ 417ë²ˆê¸¸ 52-5 ë‚˜ë™ 502í˜¸', '']);
                data.push(['', '', '', 'ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:', '405-08-53668', '']);
                data.push(['', '', '', '', '', '']);
                
                // ê²¬ì  í•­ëª© í—¤ë”
                data.push(['NO', 'ì„œë¹„ìŠ¤/ì œí’ˆëª…', 'ê·œê²©/ì‚¬ì–‘', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'ê¸ˆì•¡']);
                
                // ê²¬ì  í•­ëª©ë“¤
                const quoteRows = document.querySelectorAll('#quoteItems tr');
                let itemCount = 0;
                quoteRows.forEach((row, index) => {
                    const service = row.cells[1].querySelector('select').value;
                    const spec = row.cells[2].querySelector('textarea').value;
                    const quantity = parseInt(row.cells[3].querySelector('input').value) || 0;
                    const price = parseInt(row.cells[4].querySelector('input').value) || 0;
                    const amount = parseInt(row.cells[5].querySelector('input').value) || 0;
                    
                    if (service) {
                        itemCount++;
                        data.push([itemCount, service, spec, quantity, price, amount]);
                    }
                });
                
                // í• ì¸/ì¶”ê°€ ì„œë¹„ìŠ¤
                const discount = parseInt(document.getElementById('discountAmount').value) || 0;
                const additional = parseInt(document.getElementById('additionalAmount').value) || 0;
                if (discount > 0) {
                    data.push(['', 'í• ì¸ ì ìš©', '', '', '', -discount]);
                }
                if (additional > 0) {
                    data.push(['', 'ì¶”ê°€ ì„œë¹„ìŠ¤', '', '', '', additional]);
                }
                
                data.push(['', '', '', '', '', '']);
                
                // í•©ê³„
                const totalBeforeVat = parseInt(document.getElementById('totalBeforeVat').textContent.replace('ì›', '').replace(/,/g, '')) || 0;
                const vat = parseInt(document.getElementById('vat').textContent.replace('ì›', '').replace(/,/g, '')) || 0;
                const finalTotal = parseInt(document.getElementById('finalTotal').textContent.replace('ì›', '').replace(/,/g, '')) || 0;
                
                data.push(['', '', '', '', 'ê²¬ì ê¸ˆì•¡:', totalBeforeVat]);
                data.push(['', '', '', '', 'ë¶€ê°€ì„¸(10%):', vat]);
                data.push(['', '', '', '', 'ì´ ê³„ì•½ê¸ˆì•¡:', finalTotal]);
                
                // ì›Œí¬ì‹œíŠ¸ ìƒì„±
                const ws = XLSX.utils.aoa_to_sheet(data);
                
                // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
                ws['!cols'] = [
                    { wch: 8 },   // NO
                    { wch: 25 },  // ì„œë¹„ìŠ¤/ì œí’ˆëª…
                    { wch: 40 },  // ê·œê²©/ì‚¬ì–‘
                    { wch: 8 },   // ìˆ˜ëŸ‰
                    { wch: 15 },  // ë‹¨ê°€
                    { wch: 15 }   // ê¸ˆì•¡
                ];
                
                // ì›Œí¬ì‹œíŠ¸ë¥¼ ì›Œí¬ë¶ì— ì¶”ê°€
                XLSX.utils.book_append_sheet(wb, ws, 'ê²¬ì ì„œ');
                
                // Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const quoteNumber = document.getElementById('quoteNumber').value;
                XLSX.writeFile(wb, `IBS_ê²¬ì ì„œ_${quoteNumber}.xlsx`);
                
                btn.textContent = 'ì—‘ì…€ ì™„ë£Œ!';
                btn.style.backgroundColor = '#28a745';
                
                alert('âœ… Excel íŒŒì¼(.xlsx)ì´ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#17a2b8';
                    btn.disabled = false;
                }, 3000);
                
            } catch (error) {
                console.error('Excel ìƒì„± ì˜¤ë¥˜:', error);
                btn.textContent = 'ì—‘ì…€ ì‹¤íŒ¨';
                btn.style.backgroundColor = '#dc3545';
                
                alert('âŒ Excel ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nCSV í˜•íƒœë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.');
                
                // ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ CSV ë‹¤ìš´ë¡œë“œ ì‚¬ìš©
                downloadCSVFallback();
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#17a2b8';
                    btn.disabled = false;
                }, 3000);
            }
        }
        
        // CSV ëŒ€ì²´ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
        function downloadCSVFallback() {
            const rows = [];
            
            rows.push(['IBS ê²¬ì ì„œ (ê°œì„ ë²„ì „)', '', '', '', '', '']);
            rows.push(['ì•„ì´ë¹„ì—ìŠ¤(I.B.S) - InnoBridge SOLUTION', '', '', '', '', '']);
            rows.push(['', '', '', '', '', '']);
            
            rows.push(['ê²¬ì ë²ˆí˜¸:', document.getElementById('quoteNumber').value, '', 'ê²¬ì ì¼ì:', document.getElementById('quoteDate').value, '']);
            rows.push(['í”„ë¡œì íŠ¸ëª…:', document.getElementById('projectName').value, '', 'ë‚©í’ˆê¸°í•œ:', document.getElementById('deliveryDays').selectedOptions[0].text, '']);
            rows.push(['ê²°ì œì¡°ê±´:', document.getElementById('paymentTerms').value, '', '', '', '']);
            rows.push(['', '', '', '', '', '']);
            
            rows.push(['ê³ ê°ì •ë³´', '', '', 'ê³µê¸‰ìì •ë³´', '', '']);
            rows.push(['ì—…ì²´ëª…:', document.getElementById('clientCompany').value, '', 'ìƒí˜¸:', 'ì•„ì´ë¹„ì—ìŠ¤(I.B.S)', '']);
            rows.push(['ë‹´ë‹¹ì:', document.getElementById('clientContact').value, '', 'ë‹´ë‹¹ì:', 'ì´ì¤€ë¡œ ëŒ€í‘œ', '']);
            rows.push(['ì „í™”ë²ˆí˜¸:', document.getElementById('clientPhone').value, '', 'ì „í™”ë²ˆí˜¸:', '010-3664-6268', '']);
            rows.push(['ì´ë©”ì¼:', document.getElementById('clientEmail').value, '', 'ì´ë©”ì¼:', 'jr.lee@ibs-info.com', '']);
            rows.push(['ì£¼ì†Œ:', document.getElementById('clientAddress').value, '', 'ì£¼ì†Œ:', 'ê²½ê¸°ë„ ìˆ˜ì›ì‹œ ì¥ì•ˆêµ¬ ë•ì˜ëŒ€ë¡œ 417ë²ˆê¸¸ 52-5 ë‚˜ë™ 502í˜¸', '']);
            rows.push(['', '', '', 'ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:', '405-08-53668', '']);
            rows.push(['', '', '', '', '', '']);
            
            rows.push(['NO', 'ì„œë¹„ìŠ¤/ì œí’ˆëª…', 'ê·œê²©/ì‚¬ì–‘', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'ê¸ˆì•¡']);
            
            const quoteRows = document.querySelectorAll('#quoteItems tr');
            quoteRows.forEach((row, index) => {
                const service = row.cells[1].querySelector('select').value;
                const spec = row.cells[2].querySelector('textarea').value;
                const quantity = row.cells[3].querySelector('input').value;
                const price = row.cells[4].querySelector('input').value;
                const amount = row.cells[5].querySelector('input').value;
                
                if (service) {
                    rows.push([index + 1, service, spec, quantity, price, amount]);
                }
            });
            
            const discount = document.getElementById('discountAmount').value;
            const additional = document.getElementById('additionalAmount').value;
            if (discount > 0) {
                rows.push(['', 'í• ì¸ ì ìš©', '', '', '', '-' + discount]);
            }
            if (additional > 0) {
                rows.push(['', 'ì¶”ê°€ ì„œë¹„ìŠ¤', '', '', '', additional]);
            }
            
            rows.push(['', '', '', '', '', '']);
            
            rows.push(['', '', '', '', 'ê²¬ì ê¸ˆì•¡:', document.getElementById('totalBeforeVat').textContent.replace('ì›', '')]);
            rows.push(['', '', '', '', 'ë¶€ê°€ì„¸(10%):', document.getElementById('vat').textContent.replace('ì›', '')]);
            rows.push(['', '', '', '', 'ì´ ê³„ì•½ê¸ˆì•¡:', document.getElementById('finalTotal').textContent.replace('ì›', '')]);
            
            const csvContent = rows.map(row => 
                row.map(cell => `"${cell}"`).join(',')
            ).join('\n');
            
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `IBS_ê²¬ì ì„œ_${document.getElementById('quoteNumber').value}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // PDF ìƒì„± (í”„ë¦°íŠ¸ ë°©ì‹)
        function downloadPDF() {
            // ë²„íŠ¼ê³¼ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
            const buttons = document.querySelectorAll('.btn-group');
            const notice = document.querySelector('.data-notice');
            buttons.forEach(btn => btn.style.display = 'none');
            if (notice) notice.style.display = 'none';
            
            // í”„ë¦°íŠ¸ ì°½ ì—´ê¸°
            setTimeout(() => {
                window.print();
                
                // ë²„íŠ¼ê³¼ ì•Œë¦¼ ë‹¤ì‹œ í‘œì‹œ
                setTimeout(() => {
                    buttons.forEach(btn => btn.style.display = 'block');
                    if (notice) notice.style.display = 'block';
                }, 1000);
            }, 500);
        }
        

        
        // Gmail ë©”ì¼ ì „ì†¡
        function sendEmail() {
            try {
                // í•„ìˆ˜ ì •ë³´ í™•ì¸
                const clientEmail = document.getElementById('clientEmail').value;
                const clientCompany = document.getElementById('clientCompany').value;
                const clientContact = document.getElementById('clientContact').value;
                const quoteNumber = document.getElementById('quoteNumber').value;
                
                if (!clientEmail) {
                    throw new Error('ê³ ê° ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
                if (!clientCompany) {
                    throw new Error('ê³ ê° ì—…ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
                
                // ë©”ì¼ ë‚´ìš© ì‘ì„±
                const finalTotal = document.getElementById('finalTotal').textContent;
                const projectName = document.getElementById('projectName').value || 'í”„ë¡œì íŠ¸';
                
                const subject = `[I.B.S] ${projectName} ê²¬ì ì„œ (${quoteNumber})`;
                
                const body = `ì•ˆë…•í•˜ì„¸ìš”, ${clientContact || 'ë‹´ë‹¹ì'}ë‹˜.

ì•„ì´ë¹„ì—ìŠ¤(InnoBridge SOLUTION)ì…ë‹ˆë‹¤.

ìš”ì²­í•´ì£¼ì‹  ${projectName}ì— ëŒ€í•œ ê²¬ì ì„œë¥¼ ì²¨ë¶€íŒŒì¼ë¡œ ë³´ë‚´ë“œë¦½ë‹ˆë‹¤.

ğŸ“‹ ê²¬ì  ìš”ì•½:
â€¢ ê²¬ì ë²ˆí˜¸: ${quoteNumber}
â€¢ í”„ë¡œì íŠ¸: ${projectName}
â€¢ ì´ ê³„ì•½ê¸ˆì•¡: ${finalTotal}

ì²¨ë¶€ëœ ê²¬ì ì„œë¥¼ ê²€í† í•´ë³´ì‹œê³ , ê¶ê¸ˆí•œ ì‚¬í•­ì´ë‚˜ ì¶”ê°€ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ì—°ë½ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.

ğŸ“§ íšŒì‹ ì€ ëŒ€í‘œë©”ì¼(ibs@ibs-info.com)ë¡œ ë³´ë‚´ì£¼ì‹œë©´ ë¹ ë¥¸ ë‹µë³€ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤.

---
ì•„ì´ë¹„ì—ìŠ¤(I.B.S) - INNOVATION BRIDGE SOLUTION
ë‹´ë‹¹ì: ì´ì¤€ë¡œ ëŒ€í‘œ
ì „í™”: 010-3664-6268
íŒ©ìŠ¤: 0504-440-6268
í™ˆí˜ì´ì§€: web.ibs-info.com
ì´ë©”ì¼: ibs@ibs-info.com (íšŒì‹ ìš© ëŒ€í‘œë©”ì¼)
ì£¼ì†Œ: ê²½ê¸°ë„ ìˆ˜ì›ì‹œ ì¥ì•ˆêµ¬ ë•ì˜ëŒ€ë¡œ 417ë²ˆê¸¸ 52-5 ë‚˜ë™ 502í˜¸
ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 405-08-53668`;
                
                // Gmail ì‘ì„± URL ìƒì„±
                const fromEmail = 'jr.lee@ibs-info.com';
                const gmailUrl = `https://mail.google.com/mail/u/${fromEmail}/?view=cm&fs=1&from=${encodeURIComponent(fromEmail)}&to=${encodeURIComponent(clientEmail)}&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                
                // ì•ˆë‚´ ë©”ì‹œì§€
                alert(`ğŸ“§ Gmailì´ ì—´ë¦½ë‹ˆë‹¤!\n\nğŸ“‹ ì§„í–‰ ìˆœì„œ:\n1. PDF ìƒì„± ë²„íŠ¼ì„ ë¨¼ì € í´ë¦­í•˜ì—¬ ê²¬ì ì„œ PDFë¥¼ ì €ì¥í•˜ì„¸ìš”\n2. Gmailì—ì„œ PDF íŒŒì¼ì„ ì²¨ë¶€í•˜ì„¸ìš”\n3. ì „ì†¡ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”\n\nâœ… ë°›ëŠ” ì‚¬ëŒ: ${clientEmail}`);
                
                // Gmail ì—´ê¸°
                window.open(gmailUrl, '_blank');
                
            } catch (error) {
                alert(`âŒ ${error.message}`);
            }
        }

        // í”„ë¦°íŠ¸ ê¸°ë°˜ PDF ìƒì„± (ëŒ€ì•ˆ)
        function downloadPDFPrint() {
            // ë²„íŠ¼ê³¼ ì•Œë¦¼ ìˆ¨ê¸°ê¸°
            const buttons = document.querySelectorAll('.btn-group, .quote-table button, .company-seal button');
            const notice = document.querySelector('.data-notice');
            buttons.forEach(button => button.style.display = 'none');
            if (notice) notice.style.display = 'none';
            
            // í”„ë¦°íŠ¸ ìŠ¤íƒ€ì¼ ì ìš©
            const printStyle = document.createElement('style');
            printStyle.id = 'print-style';
            printStyle.textContent = `
                @media print {
                    body * { visibility: hidden; }
                    .container, .container * { visibility: visible; }
                    .container { 
                        position: absolute; 
                        left: 0; 
                        top: 0; 
                        width: 100% !important;
                        margin: 0 !important;
                        padding: 0 !important;
                    }
                    .btn-group, .quote-table button, .company-seal button, .data-notice { 
                        display: none !important; 
                    }
                }
            `;
            document.head.appendChild(printStyle);
            
            // í”„ë¦°íŠ¸ ì‹¤í–‰
            setTimeout(() => {
                window.print();
                
                // ì •ë¦¬
                setTimeout(() => {
                    document.head.removeChild(printStyle);
                    buttons.forEach(button => button.style.display = '');
                    if (notice) notice.style.display = '';
                }, 1000);
            }, 500);
        }




        // ê²¬ì ì„œë¥¼ ê±°ë˜ëª…ì„¸ì„œì—ì„œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë„ë¡ ì €ì¥
        function saveQuotationForDelivery() {
            try {
                // ê²¬ì ì„œ ë°ì´í„° ìˆ˜ì§‘
                const quotationData = {
                    quoteNumber: document.getElementById('quoteNumber').value || 'IBS-' + new Date().getFullYear() + '-' + String(Date.now()).slice(-3),
                    projectName: document.getElementById('projectName').value || 'í”„ë¡œì íŠ¸',
                    clientCompany: document.getElementById('clientCompany').value || 'ê³ ê°ì‚¬',
                    clientContact: document.getElementById('clientContact').value || 'ë‹´ë‹¹ì',
                    quoteDate: document.getElementById('quoteDate').value,
                    validUntil: document.getElementById('validUntil').value,
                    
                    // í’ˆëª© ë°ì´í„° ìˆ˜ì§‘
                    items: [],
                    
                    // ê¸ˆì•¡ ì •ë³´
                    subtotal: 0,
                    discountAmount: 0,
                    finalAmount: 0,
                    vatAmount: 0,
                    totalAmount: 0,
                    
                    // ë©”íƒ€ë°ì´í„°
                    type: 'quotation',
                    createdDate: new Date().toISOString(),
                    lastModified: new Date().toISOString()
                };
                
                // í…Œì´ë¸”ì—ì„œ í’ˆëª© ë°ì´í„° ì¶”ì¶œ
                const rows = document.querySelectorAll('.quote-table tbody tr');
                let subtotal = 0;
                
                rows.forEach((row, index) => {
                    const serviceSelect = row.querySelector('select');
                    const specTextarea = row.querySelector('textarea');
                    const quantityInput = row.querySelector('input[type="number"]');
                    const priceInput = row.querySelectorAll('input')[1]; // ë‘ ë²ˆì§¸ inputì´ ë‹¨ê°€
                    const amountInput = row.querySelectorAll('input')[2]; // ì„¸ ë²ˆì§¸ inputì´ ê¸ˆì•¡
                    
                    if (serviceSelect && serviceSelect.value && specTextarea) {
                        const quantity = parseInt(quantityInput.value) || 1;
                        const unitPrice = parseNumber(priceInput.value) || 0;
                        const amount = parseNumber(amountInput.value) || (quantity * unitPrice);
                        
                        quotationData.items.push({
                            no: index + 1,
                            serviceName: serviceSelect.value,
                            specification: specTextarea.value,
                            quantity: quantity,
                            unitPrice: unitPrice,
                            amount: amount
                        });
                        
                        subtotal += amount;
                    }
                });
                
                // ê¸ˆì•¡ ê³„ì‚°
                const discountAmount = parseNumber(document.getElementById('discountAmount').value) || 0;
                const additionalAmount = parseNumber(document.getElementById('additionalAmount').value) || 0;
                const finalAmount = subtotal - discountAmount + additionalAmount;
                const vatAmount = Math.floor(finalAmount * 0.1);
                const totalAmount = finalAmount + vatAmount;
                
                quotationData.subtotal = subtotal;
                quotationData.discountAmount = discountAmount;
                quotationData.finalAmount = finalAmount;
                quotationData.vatAmount = vatAmount;
                quotationData.totalAmount = totalAmount;
                
                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                const key = `quotation_${quotationData.quoteNumber}_${Date.now()}`;
                localStorage.setItem(key, JSON.stringify(quotationData));
                
                alert(`âœ… ê²¬ì ì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nê²¬ì ë²ˆí˜¸: ${quotationData.quoteNumber}\nê³ ê°ì‚¬: ${quotationData.clientCompany}\nì´ê¸ˆì•¡: ${formatNumber(quotationData.totalAmount)}ì›\n\nâ€» ì´ì œ ê±°ë˜ëª…ì„¸ì„œì—ì„œ ì´ ê²¬ì ì„œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                console.log('ğŸ’¾ ê²¬ì ì„œ ì €ì¥ ì™„ë£Œ:', quotationData);
                
            } catch (error) {
                console.error('âŒ ê²¬ì ì„œ ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ê²¬ì ì„œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // êµ¬ê¸€ì‹œíŠ¸ ì €ì¥ ê¸°ëŠ¥ (ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ ê°•í™”)
        function saveToGoogleSheets() {
            // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
            if (window.isSaving) {
                console.log('âš ï¸ ì´ë¯¸ ì €ì¥ ì¤‘ì…ë‹ˆë‹¤');
                alert('ì´ë¯¸ ì €ì¥ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
                return;
            }
            window.isSaving = true;
            
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'ì €ì¥ ì¤‘...';
            btn.disabled = true;
            
            try {
                // ê²¬ì ì„œ ë°ì´í„° ìˆ˜ì§‘ (ì‹¤ì œ ì‹œíŠ¸ êµ¬ì¡°ì— ë§ì¶¤)
                const quotationData = {
                    quoteNumber: document.getElementById('quoteNumber').value,
                    quoteDate: document.getElementById('quoteDate').value,
                    projectName: document.getElementById('projectName').value,
                    deliveryDays: document.getElementById('deliveryDays').value,
                    paymentTerms: document.getElementById('paymentTerms').value,
                    clientCompany: document.getElementById('clientCompany').value,
                    clientContact: document.getElementById('clientContact').value,
                    clientPhone: document.getElementById('clientPhone').value,
                    clientEmail: document.getElementById('clientEmail').value,
                    clientAddress: document.getElementById('clientAddress').value,
                    quoteStatus: document.getElementById('quoteStatus').value,
                    discountAmount: parseNumber(document.getElementById('discountAmount').value) || 0,
                    additionalAmount: parseNumber(document.getElementById('additionalAmount').value) || 0,
                    subtotal: parseNumber(document.getElementById('totalBeforeVat').textContent.replace('ì›', '').replace(/,/g, '')) || 0,
                    vat: parseNumber(document.getElementById('vat').textContent.replace('ì›', '').replace(/,/g, '')) || 0,
                    finalTotal: parseNumber(document.getElementById('finalTotal').textContent.replace('ì›', '').replace(/,/g, '')) || 0,
                    items: []
                };
                
                // ê²¬ì  í•­ëª©ë“¤ ìˆ˜ì§‘ (ìˆ«ì ë³€í™˜ ì ìš©)
                const rows = document.querySelectorAll('#quoteItems tr');
                rows.forEach(row => {
                    const service = row.cells[1].querySelector('select').value;
                    const spec = row.cells[2].querySelector('textarea').value;
                    const quantity = parseNumber(row.cells[3].querySelector('input').value) || 0;
                    const price = parseNumber(row.cells[4].querySelector('input').value) || 0;
                    const amount = parseNumber(row.cells[5].querySelector('input').value) || 0;
                    
                    if (service || spec || quantity > 0 || price > 0) { // ë¹ˆ í•­ëª©ì´ ì•„ë‹Œ ê²½ìš°ë§Œ ì¶”ê°€
                        quotationData.items.push({
                            service: service,
                            spec: spec,
                            quantity: quantity,
                            price: price,
                            amount: amount
                        });
                    }
                });
                
                // í•„ìˆ˜ ë°ì´í„° ê²€ì¦
                if (!quotationData.quoteNumber) {
                    throw new Error('ê²¬ì ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
                if (!quotationData.clientCompany) {
                    throw new Error('ê³ ê° ì—…ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                }
                
                // Google Apps Script ì›¹ì•± URL (ìƒˆë¡œ ë°°í¬ëœ ë²„ì „)
                const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbw-8f6dWXixqUpfbHDbP4zS6kBEzitkqk4e148rvWxFQpeINaA8XAvrOY_nUb7Kra2jCA/exec';
                
                // êµ¬ê¸€ì‹œíŠ¸ë¡œ ë°ì´í„° ì „ì†¡
                fetch(WEBAPP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(quotationData)
                })
                .then(response => {
                    // no-cors ëª¨ë“œì—ì„œëŠ” responseë¥¼ ì½ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
                    window.isSaving = false; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ flag í•´ì œ
                    btn.textContent = 'ì €ì¥ ì™„ë£Œ!';
                    btn.style.backgroundColor = '#28a745';
                    
                    alert(`âœ… ê²¬ì ì„œê°€ êµ¬ê¸€ì‹œíŠ¸ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\nê²¬ì ë²ˆí˜¸: ${quotationData.quoteNumber}\n\nêµ¬ê¸€ì‹œíŠ¸ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”.`);
                    
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.style.backgroundColor = '#0f9d58';
                        btn.disabled = false;
                    }, 3000);
                })
                .catch(error => {
                    console.error('êµ¬ê¸€ì‹œíŠ¸ ì €ì¥ ì˜¤ë¥˜:', error);
                    window.isSaving = false; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ flag í•´ì œ
                    btn.textContent = 'ì €ì¥ ì‹¤íŒ¨';
                    btn.style.backgroundColor = '#dc3545';
                    
                    alert('âŒ êµ¬ê¸€ì‹œíŠ¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\në‹¤ìŒì„ í™•ì¸í•´ì£¼ì„¸ìš”:\n1. ì¸í„°ë„· ì—°ê²° ìƒíƒœ\n2. Google Apps Script ì›¹ì•± URL\n3. ê¶Œí•œ ì„¤ì •');
                    
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.style.backgroundColor = '#0f9d58';
                        btn.disabled = false;
                    }, 3000);
                });
                
            } catch (error) {
                console.error('ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜:', error);
                window.isSaving = false; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€ flag í•´ì œ
                btn.textContent = 'ì˜¤ë¥˜ ë°œìƒ';
                btn.style.backgroundColor = '#dc3545';
                
                alert(`âŒ ${error.message}`);
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#0f9d58';
                    btn.disabled = false;
                }, 3000);
            }
        }
        
        // êµ¬ê¸€ì‹œíŠ¸ ë§í¬ ì—´ê¸° í•¨ìˆ˜
        function openGoogleSheets() {
            const SPREADSHEET_ID = '1MUHiU8a0p1aBs0wU94gmmlugwmB9qSYO8NLl-qZ9-ho';
            const sheetUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}`;
            window.open(sheetUrl, '_blank');
        }

        // ğŸ›ï¸ ë“œë¡­ë‹¤ìš´ ì„¤ì • í•¨ìˆ˜
        async function setupDropdowns() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'ì„¤ì • ì¤‘...';
            btn.disabled = true;
            
            try {
                const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbw-8f6dWXixqUpfbHDbP4zS6kBEzitkqk4e148rvWxFQpeINaA8XAvrOY_nUb7Kra2jCA/exec';
                const setupUrl = WEBAPP_URL + '?action=setupQuotationValidation';
                
                const response = await fetch(setupUrl, {
                    method: 'GET'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    btn.textContent = 'ì„¤ì • ì™„ë£Œ!';
                    btn.style.backgroundColor = '#28a745';
                    
                    alert(`âœ… ê²¬ì ì„œ ì‹œíŠ¸ ë“œë¡­ë‹¤ìš´ ì„¤ì • ì™„ë£Œ!\n\nğŸ“‹ ìƒíƒœ ë“œë¡­ë‹¤ìš´: ${result.data.statusDropdowns}ê°œ í–‰\nğŸ¨ í—¤ë” ìŠ¤íƒ€ì¼ë§: ì ìš©ë¨\n\nì´ì œ ìƒíƒœ ì—´ì—ì„œ ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ìƒíƒœë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:\nâ€¢ ê²¬ì  ë°œí–‰\nâ€¢ ê²¬ì  ì§„í–‰ì¤‘\nâ€¢ ê²¬ì  ìˆ˜ì •\nâ€¢ ê³„ì•½ ì„±ì‚¬\nâ€¢ ê³„ì•½ ì‹¤íŒ¨\nâ€¢ ë³´ë¥˜`);
                } else {
                    btn.textContent = 'ì„¤ì • ì‹¤íŒ¨';
                    btn.style.backgroundColor = '#dc3545';
                    alert(`âŒ ë“œë¡­ë‹¤ìš´ ì„¤ì • ì‹¤íŒ¨: ${result.error}`);
                }
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#28a745';
                    btn.disabled = false;
                }, 3000);
                
            } catch (error) {
                console.error('ë“œë¡­ë‹¤ìš´ ì„¤ì • ì˜¤ë¥˜:', error);
                btn.textContent = 'ì„¤ì • ì‹¤íŒ¨';
                btn.style.backgroundColor = '#dc3545';
                
                alert('âŒ ë“œë¡­ë‹¤ìš´ ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#28a745';
                    btn.disabled = false;
                }, 3000);
            }
        }



        // ê³ ê¸‰ ëŒ€ì‹œë³´ë“œ ìƒì„± í•¨ìˆ˜
        async function fixDashboard() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'ìƒì„± ì¤‘...';
            btn.disabled = true;
            
            try {
                const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbyiJqdmcmKy7C10iGfcQtVjA3DdIEOROhOn9vzDhhQE1DGd8Ulh4a0mKgL6AcKopH0xxA/exec';
                const fixUrl = WEBAPP_URL + '?action=fixDashboard';
                
                await fetch(fixUrl, {
                    method: 'GET',
                    mode: 'no-cors'
                });
                
                btn.textContent = 'ìƒì„± ì™„ë£Œ!';
                btn.style.backgroundColor = '#28a745';
                
                alert('ğŸ“Š ê³ ê¸‰ ëŒ€ì‹œë³´ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nêµ¬ê¸€ì‹œíŠ¸ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì„œ í™•ì¸í•´ë³´ì„¸ìš”.\n\nìƒˆë¡œìš´ ê¸°ëŠ¥:\nğŸ“ˆ í•µì‹¬ ì§€í‘œ (KPI)\nğŸ“Š ìƒíƒœë³„ í˜„í™© ë° ë¹„ìœ¨\nğŸ’° ê¸ˆì•¡ ë¶„ì„ (ìµœì†Œ/ìµœëŒ€/ì¤‘ê°„ê°’)\nğŸ“… ìµœê·¼ í™œë™ (7ì¼/ì˜¤ëŠ˜/ì–´ì œ)\nğŸ¨ ì»¬ëŸ¬í’€í•œ ì„¹ì…˜ë³„ ë””ìì¸');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#ff6b35';
                    btn.disabled = false;
                }, 3000);
                
            } catch (error) {
                console.error('ê³ ê¸‰ ëŒ€ì‹œë³´ë“œ ìƒì„± ì˜¤ë¥˜:', error);
                btn.textContent = 'ìƒì„± ì‹¤íŒ¨';
                btn.style.backgroundColor = '#dc3545';
                
                alert('âŒ ê³ ê¸‰ ëŒ€ì‹œë³´ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#ff6b35';
                    btn.disabled = false;
                }, 3000);
            }
        }

        // ì°¨íŠ¸ ìƒì„± í•¨ìˆ˜
        async function createCharts() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'ì°¨íŠ¸ ìƒì„± ì¤‘...';
            btn.disabled = true;
            
            try {
                const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbyiJqdmcmKy7C10iGfcQtVjA3DdIEOROhOn9vzDhhQE1DGd8Ulh4a0mKgL6AcKopH0xxA/exec';
                const chartUrl = WEBAPP_URL + '?action=createCharts';
                
                await fetch(chartUrl, {
                    method: 'GET',
                    mode: 'no-cors'
                });
                
                btn.textContent = 'ì°¨íŠ¸ ì™„ë£Œ!';
                btn.style.backgroundColor = '#28a745';
                
                alert('ğŸ“ˆ ê³ ê¸‰ ì°¨íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nêµ¬ê¸€ì‹œíŠ¸ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì„œ í™•ì¸í•´ë³´ì„¸ìš”.\n\nìƒì„±ëœ ì°¨íŠ¸:\nğŸ“Š ìƒíƒœë³„ íŒŒì´ ì°¨íŠ¸ (ê²¬ì ë°œí–‰/ì§„í–‰ì¤‘/ì„±ì‚¬)\nğŸ“ˆ ì›”ë³„ íŠ¸ë Œë“œ ë¼ì¸ ì°¨íŠ¸ (ìµœê·¼ 6ê°œì›”)\nğŸ’° ê¸ˆì•¡ ë¶„í¬ ë§‰ëŒ€ ì°¨íŠ¸ (êµ¬ê°„ë³„ ë¶„ì„)\n\nì‹œê°ì  ë¶„ì„ìœ¼ë¡œ ë” ì‰½ê²Œ í˜„í™©ì„ íŒŒì•…í•˜ì„¸ìš”!');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#9c27b0';
                    btn.disabled = false;
                }, 3000);
                
            } catch (error) {
                console.error('ì°¨íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                btn.textContent = 'ì°¨íŠ¸ ì‹¤íŒ¨';
                btn.style.backgroundColor = '#dc3545';
                
                alert('âŒ ì°¨íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.backgroundColor = '#9c27b0';
                    btn.disabled = false;
                }, 3000);
            }
        }

        // ğŸ”— ê±°ë˜ëª…ì„¸ì„œë¡œ ë°ì´í„° ì „ì†¡ (í†µí•© ì—°ë™)
        function sendToTransaction() {
            try {
                // ì•ˆì „í•œ ìš”ì†Œ ê°’ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
                function safeGetValue(id, defaultValue = '') {
                    const element = document.getElementById(id);
                    return element ? element.value : defaultValue;
                }
                
                // ê²¬ì ì„œ ë°ì´í„° ìˆ˜ì§‘
                const quotationData = {
                    quoteNumber: safeGetValue('quoteNumber') || 'IBS-' + new Date().getFullYear() + '-' + String(Date.now()).slice(-3),
                    quoteDate: safeGetValue('quoteDate'),
                    projectName: safeGetValue('projectName') || 'í”„ë¡œì íŠ¸',
                    clientCompany: safeGetValue('clientCompany') || 'ê³ ê°ì‚¬',
                    clientContact: safeGetValue('clientContact') || 'ë‹´ë‹¹ì',
                    clientPhone: safeGetValue('clientPhone'),
                    clientEmail: safeGetValue('clientEmail'),
                    clientAddress: safeGetValue('clientAddress'),
                    paymentTerms: safeGetValue('paymentTerms'),
                    deliveryDays: safeGetValue('deliveryDays'),
                    quoteStatus: safeGetValue('quoteStatus'),
                    validUntil: safeGetValue('validUntil'),
                    items: [],
                    subtotal: 0,
                    discountAmount: 0,
                    finalAmount: 0,
                    vatAmount: 0,
                    totalAmount: 0,
                    type: 'quotation',
                    createdDate: new Date().toISOString()
                };
                
                // í…Œì´ë¸”ì—ì„œ í’ˆëª© ë°ì´í„° ì¶”ì¶œ
                const rows = document.querySelectorAll('.quote-table tbody tr');
                let subtotal = 0;
                
                rows.forEach((row, index) => {
                    const serviceSelect = row.querySelector('select');
                    const specTextarea = row.querySelector('textarea');
                    const quantityInput = row.querySelector('input[type="number"]');
                    const priceInputs = row.querySelectorAll('input[type="text"]');
                    
                    if (serviceSelect && serviceSelect.value && specTextarea) {
                        const quantity = parseInt((quantityInput && quantityInput.value) || '1') || 1;
                        const unitPrice = parseNumber((priceInputs[0] && priceInputs[0].value) || '0') || 0;
                        const amount = parseNumber((priceInputs[1] && priceInputs[1].value) || '0') || (quantity * unitPrice);
                        
                        quotationData.items.push({
                            no: index + 1,
                            serviceName: serviceSelect.value,
                            specification: specTextarea.value,
                            quantity: quantity,
                            unitPrice: unitPrice,
                            amount: amount
                        });
                        
                        subtotal += amount;
                    }
                });
                
                // ê¸ˆì•¡ ê³„ì‚°
                const discountAmount = parseNumber(safeGetValue('discountAmount')) || 0;
                const additionalAmount = parseNumber(safeGetValue('additionalAmount')) || 0;
                const finalAmount = subtotal - discountAmount + additionalAmount;
                const vatAmount = Math.floor(finalAmount * 0.1);
                const totalAmount = finalAmount + vatAmount;
                
                quotationData.subtotal = subtotal;
                quotationData.discountAmount = discountAmount;
                quotationData.finalAmount = finalAmount;
                quotationData.vatAmount = vatAmount;
                quotationData.totalAmount = totalAmount;
                
                // ë°ì´í„° ê²€ì¦
                if (!quotationData.clientCompany || quotationData.clientCompany === 'ê³ ê°ì‚¬') {
                    alert('âŒ ê³ ê° ì—…ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    const clientCompanyEl = document.getElementById('clientCompany');
                    if (clientCompanyEl) clientCompanyEl.focus();
                    return;
                }
                
                if (quotationData.items.length === 0) {
                    alert('âŒ ê²¬ì  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ê±°ë˜ëª…ì„¸ì„œì—ì„œ ì½ì„ ìˆ˜ ìˆë„ë¡)
                const key = `quotation_${quotationData.quoteNumber}_${Date.now()}`;
                localStorage.setItem(key, JSON.stringify(quotationData));
                localStorage.setItem('lastQuotationKey', key); // ìµœê·¼ ê²¬ì ì„œ í‚¤ ì €ì¥
                
                // ê±°ë˜ëª…ì„¸ì„œ í˜ì´ì§€ ì—´ê¸°
                const transactionUrl = './ibs_delivery_improved.html?from=quotation&key=' + encodeURIComponent(key);
                window.open(transactionUrl, '_blank');
                
                alert(`âœ… ê²¬ì ì„œê°€ ê±°ë˜ëª…ì„¸ì„œë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ“‹ ê²¬ì ë²ˆí˜¸: ${quotationData.quoteNumber}\nğŸ¢ ê³ ê°ì‚¬: ${quotationData.clientCompany}\nğŸ“¦ í•­ëª© ìˆ˜: ${quotationData.items.length}ê°œ\nğŸ’° ì´ê¸ˆì•¡: ${formatNumber(quotationData.totalAmount)}ì›\n\nìƒˆ ì°½ì—ì„œ ê±°ë˜ëª…ì„¸ì„œê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.`);
                
            } catch (error) {
                console.error('ê±°ë˜ëª…ì„¸ì„œ ì „ì†¡ ì˜¤ë¥˜:', error);
                alert('âŒ ê±°ë˜ëª…ì„¸ì„œ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\n\nì˜¤ë¥˜: ' + error.message);
            }
        }

        // ğŸ’° ê²¬ì ì„œ ë°ì´í„° ìˆ˜ì§‘ í•¨ìˆ˜ (ì¸ë³´ì´ìŠ¤ ì „ì†¡ìš©)
        function collectQuotationData() {
            // ì•ˆì „í•œ ìš”ì†Œ ê°’ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
            function safeGetValue(id, defaultValue = '') {
                const element = document.getElementById(id);
                return element ? element.value : defaultValue;
            }
            
            // ì•ˆì „í•œ í…ìŠ¤íŠ¸ ì»¨í…ì¸  ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
            function safeGetTextContent(id, defaultValue = '0') {
                const element = document.getElementById(id);
                return element ? element.textContent.replace('ì›', '').replace(/,/g, '') : defaultValue;
            }
            
            const quotationData = {
                quoteNumber: safeGetValue('quoteNumber'),
                quoteDate: safeGetValue('quoteDate'),
                projectName: safeGetValue('projectName'),
                deliveryDays: safeGetValue('deliveryDays'),
                paymentTerms: safeGetValue('paymentTerms'),
                clientCompany: safeGetValue('clientCompany'),
                clientContact: safeGetValue('clientContact'),
                clientPhone: safeGetValue('clientPhone'),
                clientEmail: safeGetValue('clientEmail'),
                clientAddress: safeGetValue('clientAddress'),
                quoteStatus: safeGetValue('quoteStatus'),
                discountAmount: safeGetValue('discountAmount'),
                additionalAmount: safeGetValue('additionalAmount'),
                subtotal: safeGetTextContent('totalBeforeVat'),
                vat: safeGetTextContent('vat'),
                totalAmount: safeGetTextContent('finalTotal'),
                items: []
            };
            
            // ê²¬ì  í•­ëª©ë“¤ ìˆ˜ì§‘
            const rows = document.querySelectorAll('#quoteItems tr');
            rows.forEach(row => {
                if (row.cells && row.cells.length >= 6) {
                    const selectEl = row.cells[1] ? row.cells[1].querySelector('select') : null;
                    const textareaEl = row.cells[2] ? row.cells[2].querySelector('textarea') : null;
                    const quantityEl = row.cells[3] ? row.cells[3].querySelector('input') : null;
                    const priceEl = row.cells[4] ? row.cells[4].querySelector('input') : null;
                    const amountEl = row.cells[5] ? row.cells[5].querySelector('input') : null;
                    
                    const service = selectEl ? selectEl.value : '';
                    const spec = textareaEl ? textareaEl.value : '';
                    const quantity = quantityEl ? quantityEl.value : '';
                    const price = priceEl ? priceEl.value : '';
                    const amount = amountEl ? amountEl.value : '';
                    
                    if (service || spec) { // ë¹ˆ í•­ëª©ì´ ì•„ë‹Œ ê²½ìš°ë§Œ ì¶”ê°€
                        quotationData.items.push({
                            service: service,
                            spec: spec,
                            quantity: quantity,
                            price: price,
                            amount: amount
                        });
                    }
                }
            });
            
            return quotationData;
        }

        // ğŸ’° ì¸ë³´ì´ìŠ¤ë¡œ ë°ì´í„° ì „ì†¡ (ìƒˆë¡œìš´ í•¨ìˆ˜)
        function sendToInvoice() {
            try {
                console.log('ğŸ’° ì¸ë³´ì´ìŠ¤ ì „ì†¡ ì‹œì‘');
                
                // ì•ˆì „í•œ ìš”ì†Œ ê°’ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
                function safeGetValue(id, defaultValue = '') {
                    const element = document.getElementById(id);
                    return element ? element.value : defaultValue;
                }
                
                // ê²¬ì ì„œ ë°ì´í„° ìˆ˜ì§‘ (sendToTransactionê³¼ ë™ì¼í•œ ë°©ì‹)
                const quotationData = {
                    quoteNumber: safeGetValue('quoteNumber') || 'IBS-' + new Date().getFullYear() + '-' + String(Date.now()).slice(-3),
                    quoteDate: safeGetValue('quoteDate'),
                    projectName: safeGetValue('projectName') || 'í”„ë¡œì íŠ¸',
                    clientCompany: safeGetValue('clientCompany') || 'ê³ ê°ì‚¬',
                    clientContact: safeGetValue('clientContact') || 'ë‹´ë‹¹ì',
                    clientPhone: safeGetValue('clientPhone'),
                    clientEmail: safeGetValue('clientEmail'),
                    clientAddress: safeGetValue('clientAddress'),
                    paymentTerms: safeGetValue('paymentTerms'),
                    deliveryDays: safeGetValue('deliveryDays'),
                    quoteStatus: safeGetValue('quoteStatus'),
                    validUntil: safeGetValue('validUntil'),
                    items: [],
                    subtotal: 0,
                    discountAmount: 0,
                    finalAmount: 0,
                    vatAmount: 0,
                    totalAmount: 0,
                    type: 'quotation',
                    createdDate: new Date().toISOString()
                };
                
                // í…Œì´ë¸”ì—ì„œ í’ˆëª© ë°ì´í„° ì¶”ì¶œ
                const rows = document.querySelectorAll('.quote-table tbody tr');
                let subtotal = 0;
                
                rows.forEach((row, index) => {
                    const serviceSelect = row.querySelector('select');
                    const specTextarea = row.querySelector('textarea');
                    const quantityInput = row.querySelector('input[type="number"]');
                    const priceInputs = row.querySelectorAll('input[type="text"]');
                    
                    if (serviceSelect && serviceSelect.value && specTextarea) {
                        const quantity = parseInt((quantityInput && quantityInput.value) || '1') || 1;
                        const unitPrice = parseNumber((priceInputs[0] && priceInputs[0].value) || '0') || 0;
                        const amount = parseNumber((priceInputs[1] && priceInputs[1].value) || '0') || (quantity * unitPrice);
                        
                        quotationData.items.push({
                            no: index + 1,
                            serviceName: serviceSelect.value,
                            specification: specTextarea.value,
                            quantity: quantity,
                            unitPrice: unitPrice,
                            amount: amount
                        });
                        
                        subtotal += amount;
                    }
                });
                
                // ê¸ˆì•¡ ê³„ì‚°
                const discountAmount = parseNumber(safeGetValue('discountAmount')) || 0;
                const additionalAmount = parseNumber(safeGetValue('additionalAmount')) || 0;
                const finalAmount = subtotal - discountAmount + additionalAmount;
                const vatAmount = Math.floor(finalAmount * 0.1);
                const totalAmount = finalAmount + vatAmount;
                
                quotationData.subtotal = subtotal;
                quotationData.discountAmount = discountAmount;
                quotationData.finalAmount = finalAmount;
                quotationData.vatAmount = vatAmount;
                quotationData.totalAmount = totalAmount;
                
                // ë°ì´í„° ê²€ì¦
                if (!quotationData.clientCompany || quotationData.clientCompany === 'ê³ ê°ì‚¬') {
                    alert('âŒ ê³ ê° ì—…ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    const clientCompanyEl = document.getElementById('clientCompany');
                    if (clientCompanyEl) clientCompanyEl.focus();
                    return;
                }
                
                if (quotationData.items.length === 0) {
                    alert('âŒ ê²¬ì  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                if (!confirm(`ğŸ’° ì´ ê²¬ì ì„œë¥¼ ì¸ë³´ì´ìŠ¤ë¡œ ë³€í™˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nğŸ“‹ ê²¬ì ë²ˆí˜¸: ${quotationData.quoteNumber}\nğŸ¢ ê³ ê°ì‚¬: ${quotationData.clientCompany}\nğŸ“¦ í•­ëª© ìˆ˜: ${quotationData.items.length}ê°œ\nğŸ’° ì´ê¸ˆì•¡: ${formatNumber(quotationData.totalAmount)}ì›\n\nì¸ë³´ì´ìŠ¤ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.`)) {
                    return;
                }
                
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ì¸ë³´ì´ìŠ¤ì—ì„œ ì½ì„ ìˆ˜ ìˆë„ë¡)
                const key = `quotation_${quotationData.quoteNumber}_${Date.now()}`;
                localStorage.setItem(key, JSON.stringify(quotationData));
                localStorage.setItem('lastQuotationKey', key); // ìµœê·¼ ê²¬ì ì„œ í‚¤ ì €ì¥
                
                // ì¸ë³´ì´ìŠ¤ í˜ì´ì§€ ì—´ê¸°
                const invoiceUrl = './professional_invoice_a4_optimized.html?from=quotation&key=' + encodeURIComponent(key);
                window.open(invoiceUrl, '_blank');
                
                alert(`âœ… ê²¬ì ì„œê°€ ì¸ë³´ì´ìŠ¤ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ“‹ ê²¬ì ë²ˆí˜¸: ${quotationData.quoteNumber}\nğŸ¢ ê³ ê°ì‚¬: ${quotationData.clientCompany}\nğŸ“¦ í•­ëª© ìˆ˜: ${quotationData.items.length}ê°œ\nğŸ’° ì´ê¸ˆì•¡: ${formatNumber(quotationData.totalAmount)}ì›\n\nìƒˆ ì°½ì—ì„œ ì¸ë³´ì´ìŠ¤ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.`);
                
            } catch (error) {
                console.error('ì¸ë³´ì´ìŠ¤ ì „ì†¡ ì˜¤ë¥˜:', error);
                alert('âŒ ì¸ë³´ì´ìŠ¤ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\n\nì˜¤ë¥˜: ' + error.message);
            }
        }

        document.addEventListener('input', function(e) {
            if (e.target.matches('input, select, textarea')) {
                autoSaveData();
            }
        });

        // ì˜ì–´ ë²ˆì—­ ë°ì´í„°
        const englishTranslations = {
            // í—¤ë”
            'I.B.S ê²¬ì ì„œ': 'I.B.S QUOTATION',
            'ë°˜ë„ì²´ PCB ì „ê¸°ê²€ì‚¬ JIG ì†”ë£¨ì…˜': 'Semiconductor PCB Electrical Test JIG Solution',
            
            // ê¸°ë³¸ ì •ë³´
            'ê¸°ë³¸ ì •ë³´': 'Basic Information',
            'ê²¬ì ë²ˆí˜¸': 'Quote Number',
            'ê²¬ì ì¼ì': 'Quote Date',
            'ìœ íš¨ê¸°ê°„': 'Valid Until',
            'í”„ë¡œì íŠ¸ëª…': 'Project Name',
            
            // ê³ ê° ì •ë³´
            'ê³ ê° ì •ë³´': 'Customer Information',
            'ì—…ì²´ëª…': 'Company Name',
            'ë‹´ë‹¹ì': 'Contact Person',
            'ì „í™”ë²ˆí˜¸': 'Phone Number',
            'ì´ë©”ì¼': 'Email',
            'ì£¼ì†Œ': 'Address',
            
            // ê²°ì œ ì¡°ê±´
            'ê²°ì œ ì¡°ê±´': 'Payment Terms',
            'ê²°ì œì¡°ê±´': 'Payment Terms',
            'í˜„ê¸ˆ': 'Cash',
            'ì¹´ë“œ': 'Card',
            'ê³„ì¢Œì´ì²´': 'Bank Transfer',
            'ì–´ìŒ': 'Promissory Note',
            
            // í…Œì´ë¸” í—¤ë”
            'NO': 'NO',
            'ì„œë¹„ìŠ¤/ì œí’ˆëª…': 'Service/Product',
            'ê·œê²©/ì‚¬ì–‘': 'Specification',
            'ìˆ˜ëŸ‰': 'Quantity',
            'ë‹¨ê°€': 'Unit Price',
            'ê¸ˆì•¡': 'Amount',
            'ì‚­ì œ': 'Delete',
            
            // ì„œë¹„ìŠ¤ëª… (ë” ì™„ì „í•œ ë²ˆì—­)
            'ì§ì ‘ì…ë ¥': 'Custom Input',
            'Wire Probe JIG ì„¤ê³„': 'Wire Probe JIG Design',
            'JIG ì œì‘ ì„œë¹„ìŠ¤': 'JIG Manufacturing Service',
            'MEMS JIG ê°œë°œ': 'MEMS JIG Development',
            'ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡': 'Software Training',
            'ê¸°ìˆ  ì»¨ì„¤íŒ…': 'Technical Consulting',
            'PCB ì„¤ê³„ ì„œë¹„ìŠ¤': 'PCB Design Service',
            'í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘': 'Test Fixture Manufacturing',
            'í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤': 'Programming Service',
            
            // í• ì¸ ë° ì¶”ê°€ ì„œë¹„ìŠ¤
            'í• ì¸ ë° ì¶”ê°€ ì„œë¹„ìŠ¤': 'Discount & Additional Services',
            'í• ì¸ ê¸ˆì•¡': 'Discount Amount',
                            'ì¶”ê°€ ì„œë¹„ìŠ¤': 'Additional Service',
            
            // í•©ê³„
            'ì†Œê³„': 'Subtotal',
            'í• ì¸': 'Discount',
            'ì¶”ê°€ ì„œë¹„ìŠ¤': 'Additional Service',
            'ê²¬ì ê¸ˆì•¡': 'Quote Amount',
            'ë¶€ê°€ì„¸(10%)': 'VAT (10%)',
            'ì´ ê³„ì•½ê¸ˆì•¡': 'Total Contract Amount',
            
            // ì•½ì •ì‚¬í•­
            'â€» ì•½ì •ì‚¬í•­': 'â€» Terms and Conditions',
            
            // í™”í ë‹¨ìœ„
            'ì›': 'KRW',
            
            // ë²„íŠ¼ í…ìŠ¤íŠ¸
            'í•­ëª© ì¶”ê°€': 'Add Item',
            'ì „ì²´ ì´ˆê¸°í™”': 'Clear All',
            'ì´ˆê¸°í™”': 'Clear',
            
            // í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸
            'í”„ë¡œì íŠ¸ëª…ì„ ì…ë ¥í•˜ì„¸ìš”': 'Enter project name',
            'ì—…ì²´ëª…': 'Company name',
            'ë‹´ë‹¹ìëª…': 'Contact person',
            'ì „í™”ë²ˆí˜¸': 'Phone number',
            'ì´ë©”ì¼': 'Email address',
            'ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”': 'Enter address',
            'í• ì¸ ê¸ˆì•¡': 'Discount amount',
                            'ì¶”ê°€ ì„œë¹„ìŠ¤': 'Additional service'
        };

        // ì„œë¹„ìŠ¤ ì‚¬ì–‘ ì˜ì–´ ë²ˆì—­
        const englishServiceSpecs = {
            'Wire Probe JIG ì„¤ê³„': 'â–¶ Gerber file analysis and optimization design\nâ–¶ Direct design by 20-year experienced expert\nâ–¶ 3D modeling and drawing provision\nâ–¶ Design verification and simulation',
            'JIG ì œì‘ ì„œë¹„ìŠ¤': 'â–¶ Complete product manufacturing after design completion\nâ–¶ Quality verification and testing completed\nâ–¶ 1-year free A/S included\nâ–¶ On-site installation and training',
            'MEMS JIG ê°œë°œ': 'â–¶ World\'s first electrical test MEMS JIG\nâ–¶ 20~30ã› integrated structure design\nâ–¶ High-precision measurement solution\nâ–¶ Complete product manufacturing included',
                                    'ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡': 'â–¶ IA-Station, EZ-Cat training\nâ–¶ Cam350, AutoCAD utilization\nâ–¶ 1:1 customized training (8 hours)\nâ–¶ Practice materials and manual provided',
            'ê¸°ìˆ  ì»¨ì„¤íŒ…': 'â–¶ Technical consulting based on 20 years of know-how\nâ–¶ Design process optimization\nâ–¶ Cost reduction plan proposal\nâ–¶ Regular technical support',
            'PCB ì„¤ê³„ ì„œë¹„ìŠ¤': 'â–¶ High-quality PCB design and manufacturing\nâ–¶ One-stop service from design to production\nâ–¶ Design verification and optimization\nâ–¶ Technical support and consultation',
            'í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘': 'â–¶ Customized test fixture manufacturing\nâ–¶ High-precision test support\nâ–¶ Quality assurance and verification\nâ–¶ Installation and operation training',
            'í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤': 'â–¶ Customized software development\nâ–¶ Maintenance and support included\nâ–¶ User training and documentation\nâ–¶ Technical consultation and optimization'
        };

        // ì˜ë¬¸ PDF ìƒì„± í•¨ìˆ˜ (ì™„ì „ ë²„ì „)
        function downloadEnglishPDF() {
            if (!confirm('ğŸŒ ì˜ë¬¸ PDFë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní”„ë¦°íŠ¸ ëŒ€í™”ìƒìì—ì„œ "PDFë¡œ ì €ì¥"ì„ ì„ íƒí•´ì£¼ì„¸ìš”.')) {
                return;
            }
            
            try {
                // 1. í—¤ë” ë²ˆì—­
                const header = document.querySelector('.header h1');
                if (header) header.textContent = 'I.B.S QUOTATION';
                
                const headerSubtitle = document.querySelector('.header p');
                if (headerSubtitle) headerSubtitle.textContent = 'Semiconductor PCB Electrical Test JIG Solution';
                
                // ë¡œê³  ëŒ€ì²´ í…ìŠ¤íŠ¸ ë²ˆì—­
                const logoFallback = document.querySelector('.logo-fallback');
                if (logoFallback) {
                    logoFallback.innerHTML = 'InnoBridge<br>SOLUTION';
                }
                
                // 2. ì„¹ì…˜ ì œëª© ë²ˆì—­ (ëª¨ë“  ì„¹ì…˜ í¬í•¨)
                const sectionTitles = document.querySelectorAll('.form-section h3, h3');
                sectionTitles.forEach(title => {
                    if (title) {
                        const text = title.textContent.trim();
                        const sectionTranslations = {
                            'ê¸°ë³¸ ì •ë³´': 'Basic Information',
                            'ê³ ê° ì •ë³´': 'Customer Information', 
                            'ê²°ì œ ì¡°ê±´': 'Payment Terms',
                            'í• ì¸ ë° ì¶”ê°€ ì„œë¹„ìŠ¤': 'Discount & Additional Services',
                            'ğŸ“¤ ê³µê¸‰ì ì •ë³´': 'ğŸ“¤ Supplier Information'
                        };
                        
                        if (sectionTranslations[text]) {
                            title.textContent = sectionTranslations[text];
                        }
                    }
                });
                
                // 3. ë¼ë²¨ ë²ˆì—­
                const labelTranslations = {
                    'ê²¬ì ë²ˆí˜¸': 'Quote Number',
                    'ê²¬ì ì¼ì': 'Quote Date', 
                    'ìœ íš¨ê¸°ê°„': 'Valid Until',
                    'ë‚©í’ˆê¸°í•œ': 'Delivery Period',
                    'í”„ë¡œì íŠ¸ëª…': 'Project Name',
                    'ì—…ì²´ëª…': 'Company Name',
                    'ë‹´ë‹¹ì': 'Contact Person',
                    'ì „í™”ë²ˆí˜¸': 'Phone Number',
                    'ì´ë©”ì¼': 'Email',
                    'ì£¼ì†Œ': 'Address',
                    'ìƒíƒœ': 'Status',
                    'ê²°ì œì¡°ê±´': 'Payment Terms',
                    'í• ì¸ ê¸ˆì•¡': 'Discount Amount',
                    'ì¶”ê°€ ì„œë¹„ìŠ¤': 'Additional Service'
                };
                
                const labels = document.querySelectorAll('label');
                labels.forEach(label => {
                    const text = label.textContent.trim();
                    if (labelTranslations[text]) {
                        label.textContent = labelTranslations[text];
                    }
                });
                
                // ê³µê¸‰ì ì •ë³´ ì˜ì—­ ë²ˆì—­
                const supplierTexts = document.querySelectorAll('.company-details p strong, .company-details p');
                supplierTexts.forEach(element => {
                    const text = element.textContent.trim();
                    const supplierTranslations = {
                        'ğŸ“ ì£¼ì†Œ:': 'ğŸ“ Address:',
                        'ğŸ“ ì „í™”:': 'ğŸ“ Phone:',
                        'ğŸ“  íŒ©ìŠ¤:': 'ğŸ“  Fax:',
                        'ğŸ“§ ì´ë©”ì¼:': 'ğŸ“§ Email:',
                        'ğŸŒ í™ˆí˜ì´ì§€:': 'ğŸŒ Website:',
                        'ğŸ¢ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸:': 'ğŸ¢ Business Registration:',
                        'ğŸ‘¤ ëŒ€í‘œì': 'ğŸ‘¤ CEO'
                    };
                    
                    if (supplierTranslations[text]) {
                        element.textContent = supplierTranslations[text];
                    }
                });
                
                // ì§ì¸ ê´€ë ¨ í…ìŠ¤íŠ¸ ë²ˆì—­
                const sealTexts = document.querySelectorAll('.company-seal div, .company-seal button');
                sealTexts.forEach(element => {
                    if (element.textContent.includes('íšŒì‚¬ ì§ì¸')) {
                        element.innerHTML = 'Company<br>Seal<br>(Click)';
                    }
                    if (element.textContent.trim() === 'ê¸°ë³¸') {
                        element.textContent = 'Default';
                    }
                });
                
                // 4. í…Œì´ë¸” í—¤ë” ë²ˆì—­
                const tableHeaders = document.querySelectorAll('.quote-table th');
                const headerTexts = ['NO', 'Service/Product', 'Specification', 'Quantity', 'Unit Price', 'Amount', 'Delete'];
                tableHeaders.forEach((th, index) => {
                    if (th && headerTexts[index]) {
                        th.textContent = headerTexts[index];
                    }
                });
                
                // 5. ëª¨ë“  ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ë²ˆì—­
                const allOptions = document.querySelectorAll('select option');
                const optionTranslations = {
                    // ê¸°ë³¸ ì˜µì…˜
                    'ì„ íƒí•˜ì„¸ìš”': 'Please Select',
                    'ì§ì ‘ì…ë ¥': 'Custom Input',
                    
                    // ì„œë¹„ìŠ¤ ì˜µì…˜
                    'Wire Probe JIG ì„¤ê³„': 'Wire Probe JIG Design',
                    'JIG ì œì‘ ì„œë¹„ìŠ¤': 'JIG Manufacturing Service',
                    'MEMS JIG ê°œë°œ': 'MEMS JIG Development',
                    'ì†Œí”„íŠ¸ì›¨ì–´ êµìœ¡': 'Software Training',
                    'ê¸°ìˆ  ì»¨ì„¤íŒ…': 'Technical Consulting',
                    'PCB ì„¤ê³„ ì„œë¹„ìŠ¤': 'PCB Design Service',
                    'í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜ ì œì‘': 'Test Fixture Manufacturing',
                    'í”„ë¡œê·¸ë˜ë° ì„œë¹„ìŠ¤': 'Programming Service',
                    
                    // ê²°ì œì¡°ê±´ ì˜µì…˜
                    'í˜„ê¸ˆ': 'Cash',
                    'ì¹´ë“œ': 'Card',
                    'ê³„ì¢Œì´ì²´': 'Bank Transfer',
                    'ì–´ìŒ': 'Promissory Note',
                    
                    // ìœ íš¨ê¸°ê°„/ë‚©í’ˆê¸°í•œ ì˜µì…˜
                    '7ì¼ ì´ë‚´': 'Within 7 days',
                    '10ì¼ ì´ë‚´': 'Within 10 days',
                    '14ì¼ ì´ë‚´': 'Within 14 days',
                    '15ì¼ ì´ë‚´': 'Within 15 days',
                    '21ì¼ ì´ë‚´': 'Within 21 days',
                    '30ì¼ ì´ë‚´': 'Within 30 days',
                    '60ì¼ ì´ë‚´': 'Within 60 days',
                    '90ì¼ ì´ë‚´': 'Within 90 days',
                    
                    // ìƒíƒœ ì˜µì…˜
                    'ê²¬ì  ë°œí–‰': 'Quote Issued',
                    'ê²¬ì  ì§„í–‰ì¤‘': 'Quote In Progress',
                    'ê³„ì•½ ì„±ì‚¬': 'Contract Closed',
                    
                    // ê²°ì œì¡°ê±´ ì˜µì…˜
                    'ì„ ì…ê¸ˆ': 'Advance Payment',
                    'ì°©ìˆ˜ê¸ˆ 50% + ì™„ë£Œ í›„ 50%': '50% Down + 50% Upon Completion',
                    'ì™„ë£Œ í›„ ì§€ê¸‰': 'Payment After Completion',
                    'í˜‘ì˜': 'Negotiable'
                };
                
                allOptions.forEach(option => {
                    const text = option.textContent.trim();
                    if (optionTranslations[text]) {
                        option.textContent = optionTranslations[text];
                    }
                });
                
                // 6. ì„œë¹„ìŠ¤ ì‚¬ì–‘ ë²ˆì—­ (ì‚¬ìš©ì ì‘ì„± ë‚´ìš© ì™„ì „ ë³´í˜¸)
                const specTextareas = document.querySelectorAll('.quote-table textarea');
                specTextareas.forEach(textarea => {
                    const row = textarea.closest('tr');
                    if (row) {
                        const serviceSelect = row.querySelector('select');
                        const currentValue = textarea.value.trim();
                        
                        // ë‚´ìš©ì´ ìˆìœ¼ë©´ ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ê³  ì ˆëŒ€ ë³€ê²½í•˜ì§€ ì•ŠìŒ
                        if (currentValue) {
                            // ì‹œìŠ¤í…œ ë””í´íŠ¸ í‚¤ì›Œë“œ ì²´í¬ (ë” ì—„ê²©í•˜ê²Œ)
                            const defaultKeywords = [
                                'â–¶ ê±°ë²„íŒŒì¼ ë¶„ì„', 'â–¶ 20ë…„ ê²½ë ¥', 'â–¶ 3D ëª¨ë¸ë§',
                                'â–¶ ì„¤ê³„ ì™„ë£Œ', 'â–¶ í’ˆì§ˆ ê²€ì¦', 'â–¶ 1ë…„ ë¬´ìƒ',
                                'â–¶ ì„¸ê³„ ìµœì´ˆ', 'â–¶ 20~30ã›', 'â–¶ ê³ ì •ë°€ ì¸¡ì •',
                                'â–¶ IA-Station', 'â–¶ Cam350', 'â–¶ 1:1 ë§ì¶¤',
                                'â–¶ 20ë…„ ë…¸í•˜ìš°', 'â–¶ ì„¤ê³„ í”„ë¡œì„¸ìŠ¤', 'â–¶ ë¹„ìš© ì ˆê°'
                            ];
                            
                            const isSystemDefault = defaultKeywords.some(keyword => 
                                currentValue.includes(keyword)
                            );
                            
                            // ì‹œìŠ¤í…œ ë””í´íŠ¸ê°€ ì•„ë‹ˆë©´ ì‚¬ìš©ì ì‘ì„± ë‚´ìš©ìœ¼ë¡œ íŒë‹¨í•˜ê³  ë³´í˜¸
                            if (!isSystemDefault) {
                                console.log('ì‚¬ìš©ì ì‘ì„± ë‚´ìš© ë³´í˜¸:', currentValue);
                                return; // ë³€ê²½í•˜ì§€ ì•ŠìŒ
                            }
                        }
                        
                        // ë¹ˆ ì¹¸ì´ê±°ë‚˜ í™•ì‹¤í•œ ì‹œìŠ¤í…œ ë””í´íŠ¸ì¸ ê²½ìš°ë§Œ ì˜ë¬¸ìœ¼ë¡œ ë³€ê²½
                        if (serviceSelect && serviceSelect.value && 
                            serviceSelect.value !== 'ì§ì ‘ì…ë ¥' && englishServiceSpecs[serviceSelect.value]) {
                            console.log('ë””í´íŠ¸ ì‚¬ì–‘ ì˜ë¬¸ ë³€ê²½:', serviceSelect.value);
                            textarea.value = englishServiceSpecs[serviceSelect.value];
                        }
                    }
                });
                
                // 7. í•©ê³„ ì„¹ì…˜ ë²ˆì—­
                const totalLabels = document.querySelectorAll('.total-row span:first-child');
                const totalTexts = ['Subtotal:', 'Discount:', 'Additional Service:', 'Quote Amount:', 'VAT (10%):', 'Total Contract Amount:'];
                totalLabels.forEach((label, index) => {
                    if (label && totalTexts[index]) {
                        label.textContent = totalTexts[index];
                    }
                });
                
                // 8. ê¸ˆì•¡ ë‹¨ìœ„ ë³€ê²½
                const amountElements = document.querySelectorAll('#subtotal, #discount, #additional, #totalBeforeVat, #vat, #finalTotal');
                amountElements.forEach(element => {
                    if (element && element.textContent) {
                        element.textContent = element.textContent.replace(/ì›/g, 'KRW');
                    }
                });
                
                // 9. ì•½ì •ì‚¬í•­ ë²ˆì—­
                const termsTitle = document.querySelector('.terms-section h4');
                if (termsTitle) termsTitle.textContent = 'â€» Terms and Conditions';
                
                const termsItems = document.querySelectorAll('.terms-section ol li');
                const termsTexts = [
                    'If the supplier delivers to a third-party location other than the delivery location specified in this quotation without our prior approval, we shall be exempt from the obligation to pay the supplier.',
                    'If it is clear that the supplier cannot conduct normal business or delivery, we may terminate this quotation.',
                    'The supplier may not assign the claims under this quotation to a third party without our prior approval.',
                    'When we or our customers request inspection of delivered goods, the supplier must cooperate.',
                    'Other general matters not specified shall be governed by separate contracts or general commercial practices.'
                ];
                
                termsItems.forEach((item, index) => {
                    if (item && termsTexts[index]) {
                        item.textContent = termsTexts[index];
                    }
                });
                
                // 10. ë²„íŠ¼ í…ìŠ¤íŠ¸ ë²ˆì—­
                const addButton = document.querySelector('button[onclick="addRow()"]');
                if (addButton) addButton.textContent = 'Add Item';
                
                const clearButton = document.querySelector('button[onclick="clearAll()"]');
                if (clearButton) clearButton.textContent = 'Clear All';
                
                const clearRowButtons = document.querySelectorAll('button[onclick*="clearRow"]');
                clearRowButtons.forEach(btn => {
                    if (btn) btn.textContent = 'Clear';
                });
                
                // ê¸°ë³¸ ë²„íŠ¼ ë²ˆì—­ (ì§ì¸ ê´€ë ¨)
                const defaultButtons = document.querySelectorAll('button');
                defaultButtons.forEach(btn => {
                    if (btn.textContent.trim() === 'ê¸°ë³¸') {
                        btn.textContent = 'Default';
                    }
                });
                
                // ì˜ë¬¸ PDF ì „ìš© ìŠ¤íƒ€ì¼ ì¶”ê°€ (ë ˆì´ì•„ì›ƒ ìµœì í™”)
                const englishStyle = document.createElement('style');
                englishStyle.id = 'english-pdf-style';
                englishStyle.textContent = `
                    @media print {
                        /* ì „ì²´ ì»¨í…Œì´ë„ˆ ìµœì í™” */
                        .container {
                            padding: 15px !important;
                            font-size: 10px !important;
                        }
                        
                        /* í—¤ë” ìµœì í™” */
                        .header {
                            padding: 15px 20px !important;
                            margin-bottom: 15px !important;
                            min-height: 60px !important;
                        }
                        
                        .header div:first-child {
                            gap: 15px !important;
                        }
                        
                        .header div:last-child {
                            font-size: 20px !important;
                            line-height: 1.1 !important;
                        }
                        
                        .header div:last-child span:first-child {
                            font-size: 24px !important;
                        }
                        
                        .header div:last-child span:last-child {
                            font-size: 14px !important;
                        }
                        
                        /* ë¡œê³  ìµœì í™” */
                        .header img {
                            height: 45px !important;
                            width: auto !important;
                            max-width: 150px !important;
                        }
                        
                        .logo-fallback {
                            width: 90px !important;
                            height: 45px !important;
                            font-size: 12px !important;
                            line-height: 1.1 !important;
                            font-weight: bold !important;
                        }
                        
                        /* íšŒì‚¬ëª… í…ìŠ¤íŠ¸ ìµœì í™” */
                        .header div div:last-child {
                            font-size: 18px !important;
                            line-height: 1.1 !important;
                        }
                        
                        .header div div:last-child span {
                            font-size: 10px !important;
                        }
                        
                        /* ì„¹ì…˜ ì œëª© ìµœì í™” */
                        .form-section {
                            padding: 6px 10px !important;
                            margin-bottom: 6px !important;
                        }
                        
                        .form-section h3 {
                            font-size: 13px !important;
                            margin: 0 0 4px 0 !important;
                            white-space: nowrap !important;
                        }
                        
                        /* ë¼ë²¨ ìµœì í™” */
                        label {
                            font-size: 10px !important;
                            margin-bottom: 1px !important;
                            white-space: nowrap !important;
                            overflow: hidden !important;
                            text-overflow: ellipsis !important;
                        }
                        
                        /* ì…ë ¥ í•„ë“œ ìµœì í™” */
                        input, select, textarea {
                            font-size: 9px !important;
                            padding: 2px 3px !important;
                        }
                        
                        /* í…Œì´ë¸” ìµœì í™” */
                        .quote-table {
                            font-size: 8px !important;
                            margin: 8px 0 !important;
                        }
                        
                        .quote-table th {
                            font-size: 9px !important;
                            padding: 3px 1px !important;
                            white-space: nowrap !important;
                            line-height: 1.2 !important;
                        }
                        
                        .quote-table td {
                            font-size: 8px !important;
                            padding: 2px 1px !important;
                            line-height: 1.2 !important;
                        }
                        
                        .quote-table textarea {
                            font-size: 8px !important;
                            line-height: 1.2 !important;
                            padding: 2px !important;
                        }
                        
                        /* í•©ê³„ ì„¹ì…˜ ìµœì í™” */
                        .total-section {
                            padding: 8px 10px !important;
                            margin-top: 8px !important;
                        }
                        
                        .total-row {
                            font-size: 10px !important;
                            margin-bottom: 2px !important;
                        }
                        
                        .total-row span:first-child {
                            white-space: nowrap !important;
                            font-size: 10px !important;
                        }
                        
                        .final-total {
                            font-size: 12px !important;
                            padding-top: 4px !important;
                        }
                        
                        /* ì•½ì •ì‚¬í•­ ìµœì í™” */
                        .terms-section {
                            padding: 8px 10px !important;
                            margin-top: 10px !important;
                            font-size: 8px !important;
                        }
                        
                        .terms-section h4 {
                            font-size: 10px !important;
                            margin: 0 0 6px 0 !important;
                        }
                        
                        .terms-section ol {
                            line-height: 1.2 !important;
                            padding-left: 12px !important;
                        }
                        
                        .terms-section li {
                            margin-bottom: 2px !important;
                        }
                    }
                `;
                document.head.appendChild(englishStyle);
                
                // ë²„íŠ¼ ìˆ¨ê¸°ê¸°
                const buttons = document.querySelectorAll('.btn-group');
                buttons.forEach(btn => btn.style.display = 'none');
                
                // í”„ë¦°íŠ¸ ì‹¤í–‰
                setTimeout(() => {
                    window.print();
                    
                    // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ ë³µì› (ìŠ¤íƒ€ì¼ë„ í•¨ê»˜ ì œê±°ë¨)
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                }, 500);
                
            } catch (error) {
                alert('âŒ ì˜ë¬¸ PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                location.reload();
            }
        }

                // í˜ì´ì§€ë¥¼ ì˜ì–´ë¡œ ë²ˆì—­í•˜ëŠ” í•¨ìˆ˜
        function translateToEnglish() {
            try {
                console.log('ë²ˆì—­ í•¨ìˆ˜ ì‹œì‘');
                
                // 1. í—¤ë” ë²ˆì—­
                const header = document.querySelector('.header h1');
                if (header) {
                    header.textContent = 'I.B.S QUOTATION';
                    console.log('í—¤ë” ë²ˆì—­ ì™„ë£Œ');
                }
                
                const headerSubtitle = document.querySelector('.header p');
                if (headerSubtitle) {
                    headerSubtitle.textContent = 'Semiconductor PCB Electrical Test JIG Solution';
                }
                
                // 2. ì„¹ì…˜ ì œëª© ë²ˆì—­
                const sectionTitles = document.querySelectorAll('.form-section h3');
                const sectionTranslations = ['Basic Information', 'Customer Information', 'Payment Terms', 'Discount & Additional Services'];
                sectionTitles.forEach((title, index) => {
                    if (title && sectionTranslations[index]) {
                        title.textContent = sectionTranslations[index];
                    }
                });
                console.log('ì„¹ì…˜ ì œëª© ë²ˆì—­ ì™„ë£Œ');
                
                // 3. ë¼ë²¨ ë²ˆì—­
                const labels = document.querySelectorAll('label');
                labels.forEach(label => {
                    try {
                        const text = label.textContent.trim();
                        if (text && englishTranslations[text]) {
                            label.textContent = englishTranslations[text];
                        }
                    } catch (e) {
                        console.log('ë¼ë²¨ ë²ˆì—­ ì˜¤ë¥˜:', e);
                    }
                });
                console.log('ë¼ë²¨ ë²ˆì—­ ì™„ë£Œ');
                
                // 4. í…Œì´ë¸” í—¤ë” ë²ˆì—­
                const tableHeaders = document.querySelectorAll('.quote-table th');
                const headerTranslations = ['NO', 'Service/Product', 'Specification', 'Quantity', 'Unit Price', 'Amount', 'Delete'];
                tableHeaders.forEach((header, index) => {
                    if (header && headerTranslations[index]) {
                        header.textContent = headerTranslations[index];
                    }
                });
                console.log('í…Œì´ë¸” í—¤ë” ë²ˆì—­ ì™„ë£Œ');
                
                // 5. ì„œë¹„ìŠ¤ ì˜µì…˜ ë²ˆì—­
                const serviceSelects = document.querySelectorAll('select option');
                serviceSelects.forEach(option => {
                    try {
                        const text = option.textContent.trim();
                        if (text && englishTranslations[text]) {
                            option.textContent = englishTranslations[text];
                        }
                    } catch (e) {
                        console.log('ì„œë¹„ìŠ¤ ì˜µì…˜ ë²ˆì—­ ì˜¤ë¥˜:', e);
                    }
                });
                console.log('ì„œë¹„ìŠ¤ ì˜µì…˜ ë²ˆì—­ ì™„ë£Œ');
                
                // 6. ì„œë¹„ìŠ¤ ì‚¬ì–‘ ë²ˆì—­
                const specTextareas = document.querySelectorAll('.quote-table textarea');
                specTextareas.forEach(textarea => {
                    try {
                        const row = textarea.closest('tr');
                        if (row) {
                            const serviceSelect = row.querySelector('select');
                            if (serviceSelect && serviceSelect.value && englishServiceSpecs[serviceSelect.value]) {
                                textarea.value = englishServiceSpecs[serviceSelect.value];
                            }
                        }
                    } catch (e) {
                        console.log('ì„œë¹„ìŠ¤ ì‚¬ì–‘ ë²ˆì—­ ì˜¤ë¥˜:', e);
                    }
                });
                console.log('ì„œë¹„ìŠ¤ ì‚¬ì–‘ ë²ˆì—­ ì™„ë£Œ');
                
                // 7. í•©ê³„ ì„¹ì…˜ ë²ˆì—­
                const totalLabels = document.querySelectorAll('.total-row span:first-child');
                const totalTranslations = ['Subtotal:', 'Discount:', 'Additional Service:', 'Quote Amount:', 'VAT (10%):', 'Total Contract Amount:'];
                totalLabels.forEach((label, index) => {
                    if (label && totalTranslations[index]) {
                        label.textContent = totalTranslations[index];
                    }
                });
                console.log('í•©ê³„ ì„¹ì…˜ ë²ˆì—­ ì™„ë£Œ');
                
                // 8. ê¸ˆì•¡ ë‹¨ìœ„ ë³€ê²½ (ì› â†’ KRW)
                const amountElements = document.querySelectorAll('#subtotal, #discount, #additional, #totalBeforeVat, #vat, #finalTotal');
                amountElements.forEach(element => {
                    if (element && element.textContent) {
                        element.textContent = element.textContent.replace(/ì›/g, 'KRW');
                    }
                });
                console.log('ê¸ˆì•¡ ë‹¨ìœ„ ë²ˆì—­ ì™„ë£Œ');
                
                // 9. ì•½ì •ì‚¬í•­ ë²ˆì—­
                const termsTitle = document.querySelector('.terms-section h4');
                if (termsTitle) {
                    termsTitle.textContent = 'â€» Terms and Conditions';
                }
                
                const termsItems = document.querySelectorAll('.terms-section ol li');
                const termsTranslations = [
                    'If the supplier delivers to a third-party location other than the delivery location specified in this quotation without our prior approval, we shall be exempt from the obligation to pay the supplier.',
                    'If it is clear that the supplier cannot conduct normal business or delivery, we may terminate this quotation.',
                    'The supplier may not assign the claims under this quotation to a third party without our prior approval.',
                    'When we or our customers request inspection of delivered goods, the supplier must cooperate.',
                    'Other general matters not specified shall be governed by separate contracts or general commercial practices.'
                ];
                
                termsItems.forEach((item, index) => {
                    if (item && termsTranslations[index]) {
                        item.textContent = termsTranslations[index];
                    }
                });
                console.log('ì•½ì •ì‚¬í•­ ë²ˆì—­ ì™„ë£Œ');
                
                // 10. ë²„íŠ¼ í…ìŠ¤íŠ¸ ë²ˆì—­ (í”„ë¦°íŠ¸ìš©)
                const addButton = document.querySelector('button[onclick="addRow()"]');
                if (addButton) addButton.textContent = 'Add Item';
                
                const clearButton = document.querySelector('button[onclick="clearAll()"]');
                if (clearButton) clearButton.textContent = 'Clear All';
                
                const clearRowButtons = document.querySelectorAll('button[onclick*="clearRow"]');
                clearRowButtons.forEach(btn => {
                    if (btn) btn.textContent = 'Clear';
                });
                console.log('ë²„íŠ¼ í…ìŠ¤íŠ¸ ë²ˆì—­ ì™„ë£Œ');
                
                console.log('ëª¨ë“  ë²ˆì—­ ì™„ë£Œ');
                
            } catch (error) {
                console.error('ë²ˆì—­ í•¨ìˆ˜ ì˜¤ë¥˜:', error);
                throw error;
            }
        }
    </script>
</body>
</html> 