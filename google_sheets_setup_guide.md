# 🎯 IBS 견적서 구글시트 연동 설정 가이드

## 📋 개요
IBS 견적서에서 작성한 견적서를 구글시트에 자동으로 저장하고 관리할 수 있습니다.

## 🔧 설정 단계

### 1단계: Google Apps Script 프로젝트 생성

1. **Google Apps Script 접속**
   - https://script.google.com 접속
   - 구글 계정으로 로그인

2. **새 프로젝트 생성**
   - "새 프로젝트" 클릭
   - 프로젝트명: "IBS 견적서 연동"

3. **코드 입력**
   - `quotation_google_apps_script.js` 파일의 내용을 복사
   - Apps Script 에디터에 붙여넣기

### 2단계: 구글시트 ID 확인 및 설정

1. **기존 스프레드시트 사용**
   - 현재 ID: `1Mnj5c6-IKiHqpY9YsakRAv6Y9KjiL-woaz_0KoXQaZY`
   - 또는 새로운 구글시트 생성 후 ID 변경

2. **스프레드시트 ID 확인 방법**
   ```
   https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit
   ```
   - URL에서 `/d/` 다음의 긴 문자열이 ID

### 3단계: Apps Script 배포

1. **배포 설정**
   - Apps Script에서 "배포" → "새 배포" 클릭
   - 유형: "웹 앱" 선택
   - 실행 사용자: "나" 선택
   - 액세스 권한: "모든 사용자" 선택

2. **배포 완료**
   - "배포" 버튼 클릭
   - 권한 승인 (구글 계정 인증)
   - **웹앱 URL 복사** (중요!)

### 4단계: HTML 파일 URL 설정

1. **ibs_quotation_improved.html 수정**
   ```javascript
   // 현재 코드에서 수정 필요
   const WEBAPP_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
   ```

2. **실제 URL로 변경**
   ```javascript
   const WEBAPP_URL = '복사한_웹앱_URL';
   ```

## 📊 구글시트 구조

자동 생성되는 컬럼들:
- **기본 정보**: 접수일시, 견적번호, 견적일자, 프로젝트명
- **고객 정보**: 업체명, 담당자, 전화, 이메일, 주소
- **견적 항목**: 최대 4개 항목 (서비스명, 규격, 수량, 단가, 금액)
- **금액 정보**: 할인, 추가서비스, 견적금액, 부가세, 총계약금액
- **상태**: 신규/진행중/완료 등

## 🚀 사용 방법

1. **견적서 작성**
   - IBS 견적서 HTML에서 모든 정보 입력
   - 견적 항목들 선택 및 입력

2. **구글시트 저장**
   - "구글시트 저장" 버튼 클릭
   - 자동으로 구글시트에 데이터 저장

3. **구글시트에서 관리**
   - 견적서 목록 확인
   - 상태 업데이트
   - 필터링 및 정렬
   - 차트 및 분석

## ⚠️ 주의사항

1. **필수 입력 항목**
   - 견적번호 (필수)
   - 고객 업체명 (필수)

2. **권한 설정**
   - 구글 계정이 스프레드시트에 편집 권한 필요
   - Apps Script 실행 권한 필요

3. **브라우저 제한**
   - CORS 정책으로 인해 응답 확인 제한
   - 저장 성공 여부는 구글시트에서 직접 확인

## 🔧 문제 해결

### 저장이 안 될 때
1. 웹앱 URL 확인
2. 구글 계정 로그인 상태 확인
3. 브라우저 개발자 도구에서 오류 확인
4. Apps Script 실행 로그 확인

### 권한 오류 시
1. Apps Script 프로젝트 권한 재설정
2. 구글 계정 인증 다시 진행
3. 스프레드시트 공유 설정 확인

## 📞 지원

문제 발생 시:
1. Google Apps Script 로그 확인
2. 브라우저 콘솔 오류 메시지 확인
3. 설정 단계 재검토

---

**🎉 설정 완료 후 견적서 관리가 훨씬 효율적이 됩니다!** 