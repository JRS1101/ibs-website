# ğŸ¯ IBS Analytics ì‹œìŠ¤í…œ ì„¤ì • ë° ì‚¬ìš© ê°€ì´ë“œ

## ğŸ“‹ **ê°œìš”**

IBS Analytics ì‹œìŠ¤í…œì€ ê²¬ì ì„œ, ì¸ë³´ì´ìŠ¤, ê±°ë˜ëª…ì„¸ì„œë¥¼ í†µí•© ê´€ë¦¬í•˜ê³  ì‹¤ì‹œê°„ ë¹„ì¦ˆë‹ˆìŠ¤ í†µê³„ë¥¼ ì œê³µí•˜ëŠ” ìŠ¤ë§ˆíŠ¸ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.

### âœ¨ **ì£¼ìš” ê¸°ëŠ¥**
- ğŸ“Š **ì‹¤ì‹œê°„ Analytics Widget**: ê° HTML ë¬¸ì„œì— í†µê³„ ìœ„ì ¯ í‘œì‹œ
- ğŸ“ˆ **ìë™ í†µê³„ ëŒ€ì‹œë³´ë“œ**: êµ¬ê¸€ì‹œíŠ¸ì—ì„œ ì¢…í•© í†µê³„ ê´€ë¦¬
- ğŸ”„ **ë°ì´í„° ì—°ë™**: ê²¬ì ì„œ â†’ ê±°ë˜ëª…ì„¸ì„œ â†’ ì¸ë³´ì´ìŠ¤ ìë™ ì—°ê²°
- âš¡ **ìë™í™”**: ë§¤ì¼ í†µê³„ ì—…ë°ì´íŠ¸ ë° ì•Œë¦¼ ê¸°ëŠ¥

---

## ğŸš€ **1ë‹¨ê³„: êµ¬ê¸€ Apps Script ì„¤ì •**

### **1.1 Apps Script í”„ë¡œì íŠ¸ ìƒì„±**

1. **êµ¬ê¸€ì‹œíŠ¸ ì—´ê¸°**: https://docs.google.com/spreadsheets/d/1MUHiU8a0p1aBs0wU94gmmlugwmB9qSYO8NLl-qZ9-ho/edit
2. **í™•ì¥ í”„ë¡œê·¸ë¨** â†’ **Apps Script** í´ë¦­
3. ê¸°ì¡´ ì½”ë“œ ì‚­ì œ í›„ `google_apps_script_enhanced.js` ë‚´ìš© ë³µì‚¬ ë¶™ì—¬ë„£ê¸°

### **1.2 ì›¹ì•± ë°°í¬**

```javascript
// 1. ì €ì¥ (Ctrl+S)
// 2. ë°°í¬ â†’ ìƒˆ ë°°í¬
// 3. ìœ í˜•: ì›¹ì•±
// 4. ì‹¤í–‰ ê³„ì •: ë‚˜
// 5. ì•¡ì„¸ìŠ¤ ê¶Œí•œ: ëª¨ë“  ì‚¬ìš©ì
// 6. ë°°í¬ í´ë¦­
```

### **1.3 ê¶Œí•œ ìŠ¹ì¸**

- **ìŠ¹ì¸ ê²€í† ** â†’ **ê³ ê¸‰** â†’ **í”„ë¡œì íŠ¸ë¡œ ì´ë™** â†’ **í—ˆìš©**
- ë°°í¬ëœ ì›¹ì•± URL ë³µì‚¬ (Analytics Widgetì—ì„œ ì‚¬ìš©)

---

## ğŸ”§ **2ë‹¨ê³„: HTML íŒŒì¼ ì—…ë°ì´íŠ¸**

### **2.1 Analytics Widget í™•ì¸**

ëª¨ë“  HTML íŒŒì¼ì— Analytics Widgetì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤:

- âœ… `ibs_quotation_improved.html` - ê²¬ì ì„œ í†µê³„
- âœ… `interactive_delivery_statement.html` - ê±°ë˜ëª…ì„¸ì„œ í†µê³„  
- âœ… `professional_invoice_a4_optimized.html` - ì¸ë³´ì´ìŠ¤ í†µê³„

### **2.2 Widget ê¸°ëŠ¥**

```javascript
// ğŸ“Š ì‹¤ì‹œê°„ í†µê³„ í‘œì‹œ
- ì˜¤ëŠ˜ ë¬¸ì„œ ìˆ˜
- ì´ë²ˆ ë‹¬ ê¸ˆì•¡
- í‰ê·  ê¸ˆì•¡
- ì„±ì‚¬ìœ¨/ê²°ì œìœ¨/ë°°ì†¡ìœ¨

// ğŸ“ˆ ì£¼ê°„ íŠ¸ë Œë“œ ì°¨íŠ¸
- Chart.js ê¸°ë°˜ ë¼ì¸ ì°¨íŠ¸
- ìµœê·¼ 7ì¼ ë°ì´í„°

// ğŸ”” ì‹¤ì‹œê°„ ì•Œë¦¼
- ìœ íš¨ê¸°ê°„ ì„ë°• ì•Œë¦¼
- ëª©í‘œ ë‹¬ì„±ë¥  ì•Œë¦¼
- ë°°ì†¡ ì˜ˆì • ì•Œë¦¼
```

---

## ğŸ“Š **3ë‹¨ê³„: í†µê³„ ëŒ€ì‹œë³´ë“œ í™œìš©**

### **3.1 ìë™ ì—…ë°ì´íŠ¸**

```javascript
// Apps Scriptì—ì„œ ì‹¤í–‰
function runAllUpdates() {
  updateStatsDashboard();  // í†µê³„ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
  createTriggers();        // ìë™í™” íŠ¸ë¦¬ê±° ì„¤ì •
}
```

### **3.2 ìˆ˜ë™ í†µê³„ í™•ì¸**

```javascript
// ê°œë³„ í†µê³„ í…ŒìŠ¤íŠ¸
function testAnalyticsAPI() {
  const quotationStats = getAnalyticsStats('quotation');
  const invoiceStats = getAnalyticsStats('invoice');
  const transactionStats = getAnalyticsStats('transaction');
}
```

---

## ğŸ® **4ë‹¨ê³„: ì‚¬ìš© ë°©ë²•**

### **4.1 ê²¬ì ì„œ ì‘ì„± â†’ ê±°ë˜ëª…ì„¸ì„œ â†’ ì¸ë³´ì´ìŠ¤ í”Œë¡œìš°**

```mermaid
graph LR
    A[ê²¬ì ì„œ ì‘ì„±] --> B[êµ¬ê¸€ì‹œíŠ¸ ì €ì¥]
    B --> C[ê±°ë˜ëª…ì„¸ì„œ ì „ì†¡]
    C --> D[ê±°ë˜ëª…ì„¸ì„œ ì‘ì„±]
    D --> E[ì¸ë³´ì´ìŠ¤ ìƒì„±]
    E --> F[í†µê³„ ìë™ ì—…ë°ì´íŠ¸]
```

### **4.2 Analytics Widget ì‚¬ìš©ë²•**

1. **ìœ„ì ¯ í† ê¸€**: í—¤ë” í´ë¦­ìœ¼ë¡œ ì ‘ê¸°/í¼ì¹˜ê¸°
2. **ìƒˆë¡œê³ ì¹¨**: ğŸ”„ ë²„íŠ¼ìœ¼ë¡œ ìµœì‹  ë°ì´í„° ë¡œë“œ
3. **ìë™ ì—…ë°ì´íŠ¸**: 5ë¶„ë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨
4. **ì¸ì‡„ ì‹œ ìˆ¨ê¹€**: í”„ë¦°íŠ¸í•  ë•Œ ìë™ìœ¼ë¡œ ìˆ¨ê²¨ì§

---

## ğŸ” **5ë‹¨ê³„: ë¬¸ì œ í•´ê²°**

### **5.1 Analytics Widgetì´ ì•ˆ ë³´ì¼ ë•Œ**

```javascript
// ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ í™•ì¸
console.log('Analytics Widget ìƒíƒœ:', document.getElementById('analyticsWidget'));

// ìˆ˜ë™ìœ¼ë¡œ í†µê³„ ì—…ë°ì´íŠ¸
refreshAnalytics();
```

### **5.2 êµ¬ê¸€ì‹œíŠ¸ ì—°ë™ ì˜¤ë¥˜**

```javascript
// Apps Script ë¡œê·¸ í™•ì¸
console.log('ğŸ“Š í†µê³„ ë°ì´í„° ìš”ì²­:', type);

// ìˆ˜ë™ìœ¼ë¡œ í†µê³„ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
updateStatsDashboard();
```

### **5.3 CORS ì˜¤ë¥˜ í•´ê²°**

```javascript
// Apps Script doGet í•¨ìˆ˜ì—ì„œ CORS í—¤ë” ì„¤ì •ë¨
.setHeaders({
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
  'Access-Control-Allow-Headers': 'Content-Type'
});
```

---

## ğŸ“ˆ **6ë‹¨ê³„: ê³ ê¸‰ ê¸°ëŠ¥**

### **6.1 ì»¤ìŠ¤í…€ ì•Œë¦¼ ì„¤ì •**

```javascript
// ì›” ëª©í‘œ ê¸ˆì•¡ ë³€ê²½ (ê¸°ë³¸: 1ì²œë§Œì›)
const monthlyTarget = 15000000; // 1ì²œ5ë°±ë§Œì›ìœ¼ë¡œ ë³€ê²½

// ìœ íš¨ê¸°ê°„ ì•Œë¦¼ ê¸°ê°„ ë³€ê²½ (ê¸°ë³¸: 3ì¼)
return daysUntilExpiry <= 7 && daysUntilExpiry >= 0; // 7ì¼ë¡œ ë³€ê²½
```

### **6.2 ì°¨íŠ¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•**

```javascript
// ì°¨íŠ¸ ìƒ‰ìƒ ë³€ê²½
borderColor: '#ff6b6b',           // ë¹¨ê°„ìƒ‰
backgroundColor: 'rgba(255, 107, 107, 0.1)',

// ì°¨íŠ¸ íƒ€ì… ë³€ê²½
type: 'bar',  // ë§‰ëŒ€ ì°¨íŠ¸
type: 'pie',  // íŒŒì´ ì°¨íŠ¸
```

### **6.3 ì´ë©”ì¼ ì•Œë¦¼ í™œì„±í™”**

```javascript
// Apps Scriptì—ì„œ ì´ë©”ì¼ ì•Œë¦¼ ì„¤ì •
MailApp.sendEmail(
  'your-email@example.com',
  'ê²¬ì ì„œ ìœ íš¨ê¸°ê°„ ì•Œë¦¼',
  message
);
```

---

## ğŸ¯ **7ë‹¨ê³„: ì„±ëŠ¥ ìµœì í™”**

### **7.1 ë°ì´í„° ìºì‹±**

```javascript
// ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™œìš©
localStorage.setItem('analyticsCache', JSON.stringify(data));
const cachedData = JSON.parse(localStorage.getItem('analyticsCache'));
```

### **7.2 API í˜¸ì¶œ ìµœì í™”**

```javascript
// ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€
let isLoading = false;
if (!isLoading) {
  isLoading = true;
  await fetchAnalyticsData();
  isLoading = false;
}
```

---

## ğŸ”§ **8ë‹¨ê³„: ìœ ì§€ë³´ìˆ˜**

### **8.1 ì •ê¸° ì ê²€ í•­ëª©**

- [ ] êµ¬ê¸€ì‹œíŠ¸ ë°ì´í„° ì •í•©ì„± í™•ì¸
- [ ] Analytics Widget ì •ìƒ ì‘ë™ í™•ì¸
- [ ] Apps Script ì‹¤í–‰ ë¡œê·¸ ì ê²€
- [ ] íŠ¸ë¦¬ê±° ì‘ë™ ìƒíƒœ í™•ì¸

### **8.2 ë°±ì—… ë° ë³µêµ¬**

```javascript
// êµ¬ê¸€ì‹œíŠ¸ ë°±ì—…
function backupData() {
  const backup = SpreadsheetApp.create('IBS_Backup_' + new Date().toISOString());
  // ë°ì´í„° ë³µì‚¬ ë¡œì§
}
```

---

## ğŸ“ **ì§€ì› ë° ë¬¸ì˜**

### **ê¸°ìˆ  ì§€ì›**
- ğŸ“§ ì´ë©”ì¼: support@ibs-solution.com
- ğŸ“± ì „í™”: 010-3664-6268
- ğŸŒ ì›¹ì‚¬ì´íŠ¸: https://ibs-solution.com

### **ì—…ë°ì´íŠ¸ ì •ë³´**
- ğŸ“… ì •ê¸° ì—…ë°ì´íŠ¸: ë§¤ì›” ì²«ì§¸ ì£¼
- ğŸ”” ê¸´ê¸‰ íŒ¨ì¹˜: í•„ìš”ì‹œ ì¦‰ì‹œ ë°°í¬
- ğŸ“‹ ë³€ê²½ì‚¬í•­: GitHub ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ í™•ì¸

---

## ğŸ‰ **ì™„ë£Œ!**

ì´ì œ IBS Analytics ì‹œìŠ¤í…œì´ ì™„ì „íˆ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!

### **ë‹¤ìŒ ë‹¨ê³„:**
1. ğŸ§ª í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì‹œìŠ¤í…œ ê²€ì¦
2. ğŸ“Š ì‹¤ì œ ì—…ë¬´ì— ì ìš©
3. ğŸ“ˆ ì„±ê³¼ ëª¨ë‹ˆí„°ë§ ë° ê°œì„ 
4. ğŸš€ ì¶”ê°€ ê¸°ëŠ¥ ìš”ì²­ ë° ê°œë°œ

**Happy Analytics! ğŸ“Šâœ¨** 